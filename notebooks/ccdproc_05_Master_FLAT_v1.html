
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>7.5. ccdproc-05: Master FLAT &#8212; Técnicas Experimentales en Astrofísica</title>
    
  <link rel="stylesheet" href="../_static/css/index.73d71520a4ca3b99cfee5594769eaaae.css">

    
  <link rel="stylesheet"
    href="../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      
  <link rel="stylesheet"
    href="../_static/vendor/open-sans_all/1.44.1/index.css">
  <link rel="stylesheet"
    href="../_static/vendor/lato_latin-ext/1.44.1/index.css">

    
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../_static/sphinx-book-theme.40e2e510f6b7d1648584402491bb10fe.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" />
    <link rel="stylesheet" type="text/css" href="../_static/panels-variables.06eb56fa6e07937060861dad626602ad.css" />
    
  <link rel="preload" as="script" href="../_static/js/index.3da636dd464baa7582d2.js">

    <script id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/togglebutton.js"></script>
    <script src="../_static/clipboard.min.js"></script>
    <script src="../_static/copybutton.js"></script>
    <script >var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="../_static/sphinx-book-theme.d31b09fe5c1d09cb49b26a786de4a05d.js"></script>
    <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script type="text/x-mathjax-config">MathJax.Hub.Config({"tex2jax": {"inlineMath": [["\\(", "\\)"]], "displayMath": [["\\[", "\\]"]], "processRefs": false, "processEnvironments": false}})</script>
    <script async="async" src="https://unpkg.com/thebelab@latest/lib/index.js"></script>
    <script >
        const thebe_selector = ".thebe"
        const thebe_selector_input = "pre"
        const thebe_selector_output = ".output"
    </script>
    <script async="async" src="../_static/sphinx-thebe.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="7.6. ccdproc-06: Flatfielding" href="ccdproc_06_Flatfielding_v1.html" />
    <link rel="prev" title="7.4. ccdproc-04: BIAS correction" href="ccdproc_04_Substract_BIAS_v1.html" />

    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="en" />



  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    

    <div class="container-xl">
      <div class="row">
          
<div class="col-12 col-md-3 bd-sidebar site-navigation show" id="site-navigation">
    
        <div class="navbar-brand-box">
<a class="navbar-brand text-wrap" href="../index.html">
  
  <img src="../_static/ucm_logo.png" class="logo" alt="logo">
  
  
  <h1 class="site-logo" id="site-title">Técnicas Experimentales en Astrofísica</h1>
  
</a>
</div><form class="bd-search d-flex align-items-center" action="../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form>
<nav class="bd-links" id="bd-docs-nav" aria-label="Main navigation">
    <ul class="current nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="../docs/index.html">
   1. Técnicas Experimentales en Astrofísica
  </a>
 </li>
 <li class="toctree-l1 collapsible-parent">
  <a class="reference internal" href="../docs/fotometria.html">
   2. Fotometría
  </a>
  <ul class="collapse-ul">
   <li class="toctree-l2">
    <a class="reference internal" href="../docs/fotometria_01.html">
     2.1. Introducción a la Fotometría
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../docs/fotometria_02.html">
     2.2. Instrumentos y métodos
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../docs/fotometria_03.html">
     2.3. Fotometría absoluta
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../docs/fotometria_04.html">
     2.4. Fotometría diferencial
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../docs/fotometria_05.html">
     2.5. Fotometría de objetos extensos
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../docs/fotometria_06.html">
     2.6. Fotometría sintética
    </a>
   </li>
  </ul>
  <i class="fas fa-chevron-down">
  </i>
 </li>
 <li class="toctree-l1 collapsible-parent">
  <a class="reference internal" href="../docs/espectroscopia.html">
   3. Espectroscopía
  </a>
  <ul class="collapse-ul">
   <li class="toctree-l2">
    <a class="reference internal" href="../docs/espectroscopia_01.html">
     3.1. Espectroscopía astronómica
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../docs/espectroscopia_02.html">
     3.2. Elección del espectrógrafo y configuración instrumental
    </a>
   </li>
  </ul>
  <i class="fas fa-chevron-down">
  </i>
 </li>
 <li class="toctree-l1 collapsible-parent">
  <a class="reference internal" href="../docs/P1_Introduccion_00.html">
   4. Práctica 1 Procesado de observaciones astronómicas
  </a>
  <ul class="collapse-ul">
   <li class="toctree-l2">
    <a class="reference internal" href="../docs/P1_Introduccion_01.html">
     4.1. Introducción
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../docs/P1_Introduccion_02.html">
     4.2. Redución de observaciones astronómicas
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../docs/P1_Introduccion_03.html">
     4.3. Visualización e inspección de imágenes
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../docs/P1_Introduccion_04.html">
     4.4. Programación en Python y cuadernos de Jupyter
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../docs/P1_Introduccion_05.html">
     4.5. Cuaderno de observaciones
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../docs/P1_Introduccion_06.html">
     4.6. Calibración CCD
    </a>
   </li>
  </ul>
  <i class="fas fa-chevron-down">
  </i>
 </li>
 <li class="toctree-l1 collapsible-parent">
  <a class="reference internal" href="../docs/P2_Fotometria_CCD_00.html">
   5. Práctica 2     Fotometría CCD
  </a>
  <ul class="collapse-ul">
   <li class="toctree-l2">
    <a class="reference internal" href="../docs/P2_Fotometria_CCD_01.html">
     5.1. Primeros pasos en la reducción de las observaciones
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../docs/P2_Fotometria_CCD_02.html">
     5.2. Correción de BIAS
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../docs/P2_Fotometria_CCD_03.html">
     5.3. Correción de Flat Field
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../docs/P2_Fotometria_CCD_04.html">
     5.4. Pasos finales
    </a>
   </li>
  </ul>
  <i class="fas fa-chevron-down">
  </i>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../docs/P3_Espectroscopia_Rendija_Larga.html">
   6. P3 Espectroscopía de Rendija Larga
  </a>
 </li>
 <li class="toctree-l1 current active collapsible-parent">
  <a class="reference internal" href="index-notebooks-ccdproc.html">
   7. TEA Notebooks ccdproc
  </a>
  <ul class="current collapse-ul">
   <li class="toctree-l2">
    <a class="reference internal" href="ccdproc_01_ImageCollection.html">
     7.1. ccdproc-01:   Classify images
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="ccdproc_02_Trimming.html">
     7.2. ccdproc-02:   Trimming
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="ccdproc_03_Master_BIAS.html">
     7.3. ccdproc-03:   Master BIAS
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="ccdproc_04_Substract_BIAS_v1.html">
     7.4. ccdproc-04:   BIAS correction
    </a>
   </li>
   <li class="toctree-l2 current active">
    <a class="current reference internal" href="#">
     7.5. ccdproc-05:   Master FLAT
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="ccdproc_06_Flatfielding_v1.html">
     7.6. ccdproc-06:   Flatfielding
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="fotometria_1.html">
     7.7. Ajuste Bouger y término de color
    </a>
   </li>
  </ul>
  <i class="fas fa-chevron-down">
  </i>
 </li>
 <li class="toctree-l1 collapsible-parent">
  <a class="reference internal" href="index-notebooks-examples.html">
   8. TEA Notebooks examples
  </a>
  <ul class="collapse-ul">
   <li class="toctree-l2">
    <a class="reference internal" href="example_01_Read_Display_FITS_v3.html">
     8.1. Example 1:   Reading and displaying an image
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="example_02_Master_DARK_v3.html">
     8.2. Example 2: Master DARK
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="example_03_Master_Flat_v3.html">
     8.3. Example 3: Master FLAT
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="example_04_combining_images_v1.html">
     8.4. Example 4: Combining several images
    </a>
   </li>
  </ul>
  <i class="fas fa-chevron-down">
  </i>
 </li>
</ul>

</nav> <!-- To handle the deprecated key -->

<div class="navbar_extra_footer">
  Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
</div>

</div>


          


          
<main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main">
    
    <div class="row topbar fixed-top container-xl">
    <div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show">
    </div>
    <div class="col pl-2 topbar-main">
        
        <button id="navbar-toggler" class="navbar-toggler ml-0" type="button" data-toggle="collapse"
            data-toggle="tooltip" data-placement="bottom" data-target=".site-navigation" aria-controls="navbar-menu"
            aria-expanded="true" aria-label="Toggle navigation" aria-controls="site-navigation"
            title="Toggle navigation" data-toggle="tooltip" data-placement="left">
            <i class="fas fa-bars"></i>
            <i class="fas fa-arrow-left"></i>
            <i class="fas fa-arrow-up"></i>
        </button>
        
        
<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn" aria-label="Download this page"><i
            class="fas fa-download"></i></button>

    <div class="dropdown-buttons">
        <!-- ipynb file if we had a myst markdown file -->
        
        <!-- Download raw file -->
        <a class="dropdown-buttons" href="../_sources/notebooks/ccdproc_05_Master_FLAT_v1.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Download source file" data-toggle="tooltip"
                data-placement="left">.ipynb</button></a>
        <!-- Download PDF via print -->
        <button type="button" id="download-print" class="btn btn-secondary topbarbtn" title="Print to PDF"
            onClick="window.print()" data-toggle="tooltip" data-placement="left">.pdf</button>
    </div>
</div>

        <!-- Source interaction buttons -->


        <!-- Full screen (wrap in <a> to have style consistency -->
        <a class="full-screen-button"><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip"
                data-placement="bottom" onclick="toggleFullScreen()" aria-label="Fullscreen mode"
                title="Fullscreen mode"><i
                    class="fas fa-expand"></i></button></a>

        <!-- Launch buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Launch interactive content"><i class="fas fa-rocket"></i></button>
    <div class="dropdown-buttons">
        
        <a class="binder-button" href="https://mybinder.org/v2/gh/executablebooks/jupyter-book/master?urlpath=tree/notebooks/ccdproc_05_Master_FLAT_v1.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Launch Binder" data-toggle="tooltip"
                data-placement="left"><img class="binder-button-logo"
                    src="../_static/images/logo_binder.svg"
                    alt="Interact on binder">Binder</button></a>
        
        
        
        
    </div>
</div>

    </div>

    <!-- Table of contents -->
    <div class="d-none d-md-block col-md-2 bd-toc show">
        
        <div class="tocsection onthispage pt-5 pb-3">
            <i class="fas fa-list"></i> Contents
        </div>
        <nav id="bd-toc-nav">
            <ul class="nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#overview">
   7.5.1. Overview
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#working-with-images-in-a-directory">
     7.5.1.1. Working with images in a directory
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#selecting-flats-files">
     7.5.1.2. Selecting FLATS files
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#statistics-and-display">
     7.5.1.3. Statistics and display
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#reading-the-files">
       7.5.1.3.1. Reading the files
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#analysing-the-images-data">
       7.5.1.3.2. Analysing the images data
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#building-list-of-flats-files-for-each-filter">
       7.5.1.3.3. Building list of flats files for each filter
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#display-of-files">
       7.5.1.3.4. Display of files
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#combining-the-flats-images">
     7.5.1.4. Combining the FLATS images
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#normalizing-the-flats">
     7.5.1.5. Normalizing the FLATS
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#writting-the-master-flats">
       7.5.1.5.1. Writting the Master FLATs
      </a>
     </li>
    </ul>
   </li>
  </ul>
 </li>
</ul>

        </nav>
        
    </div>
</div>
    <div id="main-content" class="row">
        <div class="col-12 col-md-9 pl-md-3 pr-md-0">
        
              <div>
                
  <div class="section" id="ccdproc-05-master-flat">
<h1><span class="section-number">7.5. </span>ccdproc-05:   Master FLAT<a class="headerlink" href="#ccdproc-05-master-flat" title="Permalink to this headline">¶</a></h1>
<div class="section" id="overview">
<h2><span class="section-number">7.5.1. </span>Overview<a class="headerlink" href="#overview" title="Permalink to this headline">¶</a></h2>
<ol class="simple">
<li><p>Build a list of FLAT image files</p></li>
<li><p>Select by filter</p></li>
<li><p>Display and statistics</p></li>
<li><p>Combine to obtain master FLAT for each filter</p></li>
</ol>
<pre>
Máster en Astrofísica UCM  -- Técnicas Experimentales en Astrofísica  
Jaime Zamorano and Nicolás Cardiel

This notebook has reproduced parts of the the astropy ccdproc docs: 
https://ccdproc.readthedocs.io/en/latest/reduction_toolbox.html#subtract-bias-and-dark

Version 1.0 2021/01/15  
</pre><p>Note that the <code class="docutils literal notranslate"><span class="pre">astropy</span></code> package should be installed. In this sense, have a look to the
astropy installation description: https://docs.astropy.org/en/stable/install.html.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">pylab</span> <span class="kn">import</span> <span class="o">*</span>
<span class="kn">import</span> <span class="nn">matplotlib</span>
<span class="o">%</span><span class="k">matplotlib</span> inline
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">matplotlib.mlab</span> <span class="k">as</span> <span class="nn">ml</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">mpl_toolkits.axes_grid1</span> <span class="kn">import</span> <span class="n">make_axes_locatable</span>
<span class="kn">from</span> <span class="nn">astropy.io</span> <span class="kn">import</span> <span class="n">fits</span>
<span class="kn">from</span> <span class="nn">astropy</span> <span class="kn">import</span> <span class="n">units</span> <span class="k">as</span> <span class="n">u</span>
<span class="kn">from</span> <span class="nn">astropy.nddata</span> <span class="kn">import</span> <span class="n">CCDData</span>
<span class="kn">import</span> <span class="nn">ccdproc</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Some parameters for nicer graphs</span>
<span class="n">matplotlib</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s1">&#39;text.usetex&#39;</span><span class="p">]</span><span class="o">=</span><span class="kc">False</span>
<span class="n">rcParams</span><span class="p">[</span><span class="s1">&#39;font.family&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;sans-serif&#39;</span>
<span class="n">rcParams</span><span class="p">[</span><span class="s1">&#39;font.sans-serif&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;Verdana&#39;</span><span class="p">]</span>
<span class="n">rcParams</span><span class="p">[</span><span class="s1">&#39;font.size&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mf">12.</span>
<span class="n">rcParams</span><span class="p">[</span><span class="s1">&#39;lines.linewidth&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mf">4.</span>
<span class="n">rcParams</span><span class="p">[</span><span class="s1">&#39;axes.labelsize&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;large&#39;</span>
<span class="n">rcParams</span><span class="p">[</span><span class="s1">&#39;grid.linewidth&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mf">1.0</span>
<span class="n">rcParams</span><span class="p">[</span><span class="s1">&#39;grid.linestyle&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;:&#39;</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="working-with-images-in-a-directory">
<h3><span class="section-number">7.5.1.1. </span>Working with images in a directory<a class="headerlink" href="#working-with-images-in-a-directory" title="Permalink to this headline">¶</a></h3>
<p>We will use the files of the first night of observations at NOT (Nordic Optical Telescope) 2008 that can be downloaded from   ftp://astrax.fis.ucm.es/pub/users/jaz/NOT_2008_04_12-14/N1/
or
http://guaix.fis.ucm.es/~jaz/master_TEA/observaciones_NOT_2008/N1/</p>
<p><code class="docutils literal notranslate"><span class="pre">directory</span></code> should point to the working directory.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">directory</span><span class="o">=</span><span class="s1">&#39;/Users/jzamorano/Desktop/NOT_2008/N1/&#39;</span>   <span class="c1"># change to the path of your own working directory</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">directory</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/Users/jzamorano/Desktop/NOT_2008/N1/
</pre></div>
</div>
</div>
</div>
<p>Let’s create a list containing all the FITS files in that directory.<br />
We asume that the images were already trimmed and their names begin with ‘zt_’ (see previous notebook ‘ccdproc_02’ ‘ccdproc_03’ ‘ccdproc_04’)</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">os</span>
<span class="kn">from</span> <span class="nn">glob</span> <span class="kn">import</span> <span class="n">glob</span>
<span class="c1"># os.path.join is a platform-independent way to join two directories</span>
<span class="n">globpath</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">directory</span><span class="p">,</span> <span class="s1">&#39;zt_*.fits&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">globpath</span><span class="p">)</span>
<span class="c1"># glob searches through directories similar to the Unix shell</span>
<span class="n">filelist</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">glob</span><span class="p">(</span><span class="n">globpath</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="n">filelist</span><span class="p">[</span><span class="mi">10</span><span class="p">:</span><span class="mi">15</span><span class="p">])</span>    <span class="c1"># printing only from 10 to 20</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/Users/jzamorano/Desktop/NOT_2008/N1/zt_*.fits
[&#39;/Users/jzamorano/Desktop/NOT_2008/N1/zt_ALrd120011.fits&#39;, &#39;/Users/jzamorano/Desktop/NOT_2008/N1/zt_ALrd120012.fits&#39;, &#39;/Users/jzamorano/Desktop/NOT_2008/N1/zt_ALrd120013.fits&#39;, &#39;/Users/jzamorano/Desktop/NOT_2008/N1/zt_ALrd120014.fits&#39;, &#39;/Users/jzamorano/Desktop/NOT_2008/N1/zt_ALrd120015.fits&#39;]
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="selecting-flats-files">
<h3><span class="section-number">7.5.1.2. </span>Selecting FLATS files<a class="headerlink" href="#selecting-flats-files" title="Permalink to this headline">¶</a></h3>
<p>See previous notebook ccdproc_01_ImageCollection</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">ccdproc</span> <span class="kn">import</span> <span class="n">ImageFileCollection</span>
<span class="kn">from</span> <span class="nn">ccdproc.utils.sample_directory</span> <span class="kn">import</span> <span class="n">sample_directory_with_files</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">keys</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;imagetyp&#39;</span><span class="p">,</span><span class="s1">&#39;OBJECT&#39;</span> <span class="p">,</span> <span class="s1">&#39;EXPTIME&#39;</span> <span class="p">,</span> <span class="s1">&#39;ALFLTID&#39;</span> <span class="p">,</span> <span class="s1">&#39;FAFLTID&#39;</span> <span class="p">,</span> <span class="s1">&#39;FBFLTID&#39;</span><span class="p">]</span>
<span class="n">ic1</span> <span class="o">=</span> <span class="n">ImageFileCollection</span><span class="p">(</span><span class="n">directory</span><span class="p">,</span> <span class="n">keywords</span><span class="o">=</span><span class="n">keys</span><span class="p">)</span> <span class="c1"># only keep track of keys</span>
<span class="n">ic1</span><span class="o">.</span><span class="n">summary</span><span class="o">.</span><span class="n">colnames</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/Library/Frameworks/Python.framework/Versions/3.7/lib/python3.7/site-packages/ccdproc/image_collection.py:546: UserWarning: Header from file &quot;/Users/jzamorano/Desktop/NOT_2008/N1/zero_N1.fits&quot; contains multiple entries for &quot;mjd-obs&quot;, the pair &quot;mjd-obs=54568.639201389&quot; will be ignored.
  UserWarning)
/Library/Frameworks/Python.framework/Versions/3.7/lib/python3.7/site-packages/ccdproc/image_collection.py:546: UserWarning: Header from file &quot;/Users/jzamorano/Desktop/NOT_2008/N1/zt_ALrd120001.fits&quot; contains multiple entries for &quot;mjd-obs&quot;, the pair &quot;mjd-obs=54568.639201389&quot; will be ignored.
  UserWarning)
/Library/Frameworks/Python.framework/Versions/3.7/lib/python3.7/site-packages/ccdproc/image_collection.py:546: UserWarning: Header from file &quot;/Users/jzamorano/Desktop/NOT_2008/N1/zt_ALrd120002.fits&quot; contains multiple entries for &quot;mjd-obs&quot;, the pair &quot;mjd-obs=54568.641284722&quot; will be ignored.
  UserWarning)
/Library/Frameworks/Python.framework/Versions/3.7/lib/python3.7/site-packages/ccdproc/image_collection.py:546: UserWarning: Header from file &quot;/Users/jzamorano/Desktop/NOT_2008/N1/zt_ALrd120003.fits&quot; contains multiple entries for &quot;mjd-obs&quot;, the pair &quot;mjd-obs=54568.642233796&quot; will be ignored.
  UserWarning)
/Library/Frameworks/Python.framework/Versions/3.7/lib/python3.7/site-packages/ccdproc/image_collection.py:546: UserWarning: Header from file &quot;/Users/jzamorano/Desktop/NOT_2008/N1/zt_ALrd120004.fits&quot; contains multiple entries for &quot;mjd-obs&quot;, the pair &quot;mjd-obs=54568.643194444&quot; will be ignored.
  UserWarning)
/Library/Frameworks/Python.framework/Versions/3.7/lib/python3.7/site-packages/ccdproc/image_collection.py:546: UserWarning: Header from file &quot;/Users/jzamorano/Desktop/NOT_2008/N1/zt_ALrd120005.fits&quot; contains multiple entries for &quot;mjd-obs&quot;, the pair &quot;mjd-obs=54568.644143519&quot; will be ignored.
  UserWarning)
/Library/Frameworks/Python.framework/Versions/3.7/lib/python3.7/site-packages/ccdproc/image_collection.py:546: UserWarning: Header from file &quot;/Users/jzamorano/Desktop/NOT_2008/N1/zt_ALrd120006.fits&quot; contains multiple entries for &quot;mjd-obs&quot;, the pair &quot;mjd-obs=54568.645092593&quot; will be ignored.
  UserWarning)
/Library/Frameworks/Python.framework/Versions/3.7/lib/python3.7/site-packages/ccdproc/image_collection.py:546: UserWarning: Header from file &quot;/Users/jzamorano/Desktop/NOT_2008/N1/zt_ALrd120007.fits&quot; contains multiple entries for &quot;mjd-obs&quot;, the pair &quot;mjd-obs=54568.646041667&quot; will be ignored.
  UserWarning)
/Library/Frameworks/Python.framework/Versions/3.7/lib/python3.7/site-packages/ccdproc/image_collection.py:546: UserWarning: Header from file &quot;/Users/jzamorano/Desktop/NOT_2008/N1/zt_ALrd120008.fits&quot; contains multiple entries for &quot;mjd-obs&quot;, the pair &quot;mjd-obs=54568.647002315&quot; will be ignored.
  UserWarning)
/Library/Frameworks/Python.framework/Versions/3.7/lib/python3.7/site-packages/ccdproc/image_collection.py:546: UserWarning: Header from file &quot;/Users/jzamorano/Desktop/NOT_2008/N1/zt_ALrd120009.fits&quot; contains multiple entries for &quot;mjd-obs&quot;, the pair &quot;mjd-obs=54568.647951389&quot; will be ignored.
  UserWarning)
/Library/Frameworks/Python.framework/Versions/3.7/lib/python3.7/site-packages/ccdproc/image_collection.py:546: UserWarning: Header from file &quot;/Users/jzamorano/Desktop/NOT_2008/N1/zt_ALrd120010.fits&quot; contains multiple entries for &quot;mjd-obs&quot;, the pair &quot;mjd-obs=54568.648900463&quot; will be ignored.
  UserWarning)
/Library/Frameworks/Python.framework/Versions/3.7/lib/python3.7/site-packages/ccdproc/image_collection.py:546: UserWarning: Header from file &quot;/Users/jzamorano/Desktop/NOT_2008/N1/zt_ALrd120011.fits&quot; contains multiple entries for &quot;mjd-obs&quot;, the pair &quot;mjd-obs=54568.662256944&quot; will be ignored.
  UserWarning)
/Library/Frameworks/Python.framework/Versions/3.7/lib/python3.7/site-packages/ccdproc/image_collection.py:546: UserWarning: Header from file &quot;/Users/jzamorano/Desktop/NOT_2008/N1/zt_ALrd120012.fits&quot; contains multiple entries for &quot;mjd-obs&quot;, the pair &quot;mjd-obs=54568.662256944&quot; will be ignored.
  UserWarning)
/Library/Frameworks/Python.framework/Versions/3.7/lib/python3.7/site-packages/ccdproc/image_collection.py:546: UserWarning: Header from file &quot;/Users/jzamorano/Desktop/NOT_2008/N1/zt_ALrd120013.fits&quot; contains multiple entries for &quot;mjd-obs&quot;, the pair &quot;mjd-obs=54568.664375&quot; will be ignored.
  UserWarning)
/Library/Frameworks/Python.framework/Versions/3.7/lib/python3.7/site-packages/ccdproc/image_collection.py:546: UserWarning: Header from file &quot;/Users/jzamorano/Desktop/NOT_2008/N1/zt_ALrd120014.fits&quot; contains multiple entries for &quot;mjd-obs&quot;, the pair &quot;mjd-obs=54568.665335648&quot; will be ignored.
  UserWarning)
/Library/Frameworks/Python.framework/Versions/3.7/lib/python3.7/site-packages/ccdproc/image_collection.py:546: UserWarning: Header from file &quot;/Users/jzamorano/Desktop/NOT_2008/N1/zt_ALrd120015.fits&quot; contains multiple entries for &quot;mjd-obs&quot;, the pair &quot;mjd-obs=54568.66630787&quot; will be ignored.
  UserWarning)
/Library/Frameworks/Python.framework/Versions/3.7/lib/python3.7/site-packages/ccdproc/image_collection.py:546: UserWarning: Header from file &quot;/Users/jzamorano/Desktop/NOT_2008/N1/zt_ALrd120016.fits&quot; contains multiple entries for &quot;mjd-obs&quot;, the pair &quot;mjd-obs=54568.667268519&quot; will be ignored.
  UserWarning)
/Library/Frameworks/Python.framework/Versions/3.7/lib/python3.7/site-packages/ccdproc/image_collection.py:546: UserWarning: Header from file &quot;/Users/jzamorano/Desktop/NOT_2008/N1/zt_ALrd120017.fits&quot; contains multiple entries for &quot;mjd-obs&quot;, the pair &quot;mjd-obs=54568.668229167&quot; will be ignored.
  UserWarning)
/Library/Frameworks/Python.framework/Versions/3.7/lib/python3.7/site-packages/ccdproc/image_collection.py:546: UserWarning: Header from file &quot;/Users/jzamorano/Desktop/NOT_2008/N1/zt_ALrd120018.fits&quot; contains multiple entries for &quot;mjd-obs&quot;, the pair &quot;mjd-obs=54568.669189815&quot; will be ignored.
  UserWarning)
/Library/Frameworks/Python.framework/Versions/3.7/lib/python3.7/site-packages/ccdproc/image_collection.py:546: UserWarning: Header from file &quot;/Users/jzamorano/Desktop/NOT_2008/N1/zt_ALrd120019.fits&quot; contains multiple entries for &quot;mjd-obs&quot;, the pair &quot;mjd-obs=54568.670162037&quot; will be ignored.
  UserWarning)
/Library/Frameworks/Python.framework/Versions/3.7/lib/python3.7/site-packages/ccdproc/image_collection.py:546: UserWarning: Header from file &quot;/Users/jzamorano/Desktop/NOT_2008/N1/zt_ALrd120020.fits&quot; contains multiple entries for &quot;mjd-obs&quot;, the pair &quot;mjd-obs=54568.671122685&quot; will be ignored.
  UserWarning)
/Library/Frameworks/Python.framework/Versions/3.7/lib/python3.7/site-packages/ccdproc/image_collection.py:546: UserWarning: Header from file &quot;/Users/jzamorano/Desktop/NOT_2008/N1/zt_ALrd120021.fits&quot; contains multiple entries for &quot;mjd-obs&quot;, the pair &quot;mjd-obs=54568.674340278&quot; will be ignored.
  UserWarning)
/Library/Frameworks/Python.framework/Versions/3.7/lib/python3.7/site-packages/ccdproc/image_collection.py:546: UserWarning: Header from file &quot;/Users/jzamorano/Desktop/NOT_2008/N1/zt_ALrd120022.fits&quot; contains multiple entries for &quot;mjd-obs&quot;, the pair &quot;mjd-obs=54568.675763889&quot; will be ignored.
  UserWarning)
/Library/Frameworks/Python.framework/Versions/3.7/lib/python3.7/site-packages/ccdproc/image_collection.py:546: UserWarning: Header from file &quot;/Users/jzamorano/Desktop/NOT_2008/N1/zt_ALrd120023.fits&quot; contains multiple entries for &quot;mjd-obs&quot;, the pair &quot;mjd-obs=54568.675763889&quot; will be ignored.
  UserWarning)
/Library/Frameworks/Python.framework/Versions/3.7/lib/python3.7/site-packages/ccdproc/image_collection.py:546: UserWarning: Header from file &quot;/Users/jzamorano/Desktop/NOT_2008/N1/zt_ALrd120024.fits&quot; contains multiple entries for &quot;mjd-obs&quot;, the pair &quot;mjd-obs=54568.679236111&quot; will be ignored.
  UserWarning)
/Library/Frameworks/Python.framework/Versions/3.7/lib/python3.7/site-packages/ccdproc/image_collection.py:546: UserWarning: Header from file &quot;/Users/jzamorano/Desktop/NOT_2008/N1/zt_ALrd120025.fits&quot; contains multiple entries for &quot;mjd-obs&quot;, the pair &quot;mjd-obs=54568.680532407&quot; will be ignored.
  UserWarning)
/Library/Frameworks/Python.framework/Versions/3.7/lib/python3.7/site-packages/ccdproc/image_collection.py:546: UserWarning: Header from file &quot;/Users/jzamorano/Desktop/NOT_2008/N1/zt_ALrd120026.fits&quot; contains multiple entries for &quot;mjd-obs&quot;, the pair &quot;mjd-obs=54568.681828704&quot; will be ignored.
  UserWarning)
/Library/Frameworks/Python.framework/Versions/3.7/lib/python3.7/site-packages/ccdproc/image_collection.py:546: UserWarning: Header from file &quot;/Users/jzamorano/Desktop/NOT_2008/N1/zt_ALrd120027.fits&quot; contains multiple entries for &quot;mjd-obs&quot;, the pair &quot;mjd-obs=54568.683136574&quot; will be ignored.
  UserWarning)
/Library/Frameworks/Python.framework/Versions/3.7/lib/python3.7/site-packages/ccdproc/image_collection.py:546: UserWarning: Header from file &quot;/Users/jzamorano/Desktop/NOT_2008/N1/zt_ALrd120028.fits&quot; contains multiple entries for &quot;mjd-obs&quot;, the pair &quot;mjd-obs=54568.68443287&quot; will be ignored.
  UserWarning)
/Library/Frameworks/Python.framework/Versions/3.7/lib/python3.7/site-packages/ccdproc/image_collection.py:546: UserWarning: Header from file &quot;/Users/jzamorano/Desktop/NOT_2008/N1/zt_ALrd120029.fits&quot; contains multiple entries for &quot;mjd-obs&quot;, the pair &quot;mjd-obs=54568.685729167&quot; will be ignored.
  UserWarning)
/Library/Frameworks/Python.framework/Versions/3.7/lib/python3.7/site-packages/ccdproc/image_collection.py:546: UserWarning: Header from file &quot;/Users/jzamorano/Desktop/NOT_2008/N1/zt_ALrd120030.fits&quot; contains multiple entries for &quot;mjd-obs&quot;, the pair &quot;mjd-obs=54568.687037037&quot; will be ignored.
  UserWarning)
/Library/Frameworks/Python.framework/Versions/3.7/lib/python3.7/site-packages/ccdproc/image_collection.py:546: UserWarning: Header from file &quot;/Users/jzamorano/Desktop/NOT_2008/N1/zt_ALrd120031.fits&quot; contains multiple entries for &quot;mjd-obs&quot;, the pair &quot;mjd-obs=54568.688333333&quot; will be ignored.
  UserWarning)
/Library/Frameworks/Python.framework/Versions/3.7/lib/python3.7/site-packages/ccdproc/image_collection.py:546: UserWarning: Header from file &quot;/Users/jzamorano/Desktop/NOT_2008/N1/zt_ALrd120032.fits&quot; contains multiple entries for &quot;mjd-obs&quot;, the pair &quot;mjd-obs=54568.68962963&quot; will be ignored.
  UserWarning)
/Library/Frameworks/Python.framework/Versions/3.7/lib/python3.7/site-packages/ccdproc/image_collection.py:546: UserWarning: Header from file &quot;/Users/jzamorano/Desktop/NOT_2008/N1/zt_ALrd120033.fits&quot; contains multiple entries for &quot;mjd-obs&quot;, the pair &quot;mjd-obs=54568.68962963&quot; will be ignored.
  UserWarning)
/Library/Frameworks/Python.framework/Versions/3.7/lib/python3.7/site-packages/ccdproc/image_collection.py:546: UserWarning: Header from file &quot;/Users/jzamorano/Desktop/NOT_2008/N1/zt_ALrd120034.fits&quot; contains multiple entries for &quot;mjd-obs&quot;, the pair &quot;mjd-obs=54568.692395833&quot; will be ignored.
  UserWarning)
/Library/Frameworks/Python.framework/Versions/3.7/lib/python3.7/site-packages/ccdproc/image_collection.py:546: UserWarning: Header from file &quot;/Users/jzamorano/Desktop/NOT_2008/N1/zt_ALrd120035.fits&quot; contains multiple entries for &quot;mjd-obs&quot;, the pair &quot;mjd-obs=54568.693576389&quot; will be ignored.
  UserWarning)
/Library/Frameworks/Python.framework/Versions/3.7/lib/python3.7/site-packages/ccdproc/image_collection.py:546: UserWarning: Header from file &quot;/Users/jzamorano/Desktop/NOT_2008/N1/zt_ALrd120036.fits&quot; contains multiple entries for &quot;mjd-obs&quot;, the pair &quot;mjd-obs=54568.694756944&quot; will be ignored.
  UserWarning)
/Library/Frameworks/Python.framework/Versions/3.7/lib/python3.7/site-packages/ccdproc/image_collection.py:546: UserWarning: Header from file &quot;/Users/jzamorano/Desktop/NOT_2008/N1/zt_ALrd120037.fits&quot; contains multiple entries for &quot;mjd-obs&quot;, the pair &quot;mjd-obs=54568.695949074&quot; will be ignored.
  UserWarning)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/Library/Frameworks/Python.framework/Versions/3.7/lib/python3.7/site-packages/ccdproc/image_collection.py:546: UserWarning: Header from file &quot;/Users/jzamorano/Desktop/NOT_2008/N1/zt_ALrd120038.fits&quot; contains multiple entries for &quot;mjd-obs&quot;, the pair &quot;mjd-obs=54568.69712963&quot; will be ignored.
  UserWarning)
/Library/Frameworks/Python.framework/Versions/3.7/lib/python3.7/site-packages/ccdproc/image_collection.py:546: UserWarning: Header from file &quot;/Users/jzamorano/Desktop/NOT_2008/N1/zt_ALrd120039.fits&quot; contains multiple entries for &quot;mjd-obs&quot;, the pair &quot;mjd-obs=54568.698310185&quot; will be ignored.
  UserWarning)
/Library/Frameworks/Python.framework/Versions/3.7/lib/python3.7/site-packages/ccdproc/image_collection.py:546: UserWarning: Header from file &quot;/Users/jzamorano/Desktop/NOT_2008/N1/zt_ALrd120040.fits&quot; contains multiple entries for &quot;mjd-obs&quot;, the pair &quot;mjd-obs=54568.699490741&quot; will be ignored.
  UserWarning)
/Library/Frameworks/Python.framework/Versions/3.7/lib/python3.7/site-packages/ccdproc/image_collection.py:546: UserWarning: Header from file &quot;/Users/jzamorano/Desktop/NOT_2008/N1/zt_ALrd120041.fits&quot; contains multiple entries for &quot;mjd-obs&quot;, the pair &quot;mjd-obs=54568.70068287&quot; will be ignored.
  UserWarning)
/Library/Frameworks/Python.framework/Versions/3.7/lib/python3.7/site-packages/ccdproc/image_collection.py:546: UserWarning: Header from file &quot;/Users/jzamorano/Desktop/NOT_2008/N1/zt_ALrd120042.fits&quot; contains multiple entries for &quot;mjd-obs&quot;, the pair &quot;mjd-obs=54568.701863426&quot; will be ignored.
  UserWarning)
/Library/Frameworks/Python.framework/Versions/3.7/lib/python3.7/site-packages/ccdproc/image_collection.py:546: UserWarning: Header from file &quot;/Users/jzamorano/Desktop/NOT_2008/N1/zt_ALrd120043.fits&quot; contains multiple entries for &quot;mjd-obs&quot;, the pair &quot;mjd-obs=54568.81380787&quot; will be ignored.
  UserWarning)
/Library/Frameworks/Python.framework/Versions/3.7/lib/python3.7/site-packages/ccdproc/image_collection.py:546: UserWarning: Header from file &quot;/Users/jzamorano/Desktop/NOT_2008/N1/zt_ALrd120044.fits&quot; contains multiple entries for &quot;mjd-obs&quot;, the pair &quot;mjd-obs=54568.819699074&quot; will be ignored.
  UserWarning)
/Library/Frameworks/Python.framework/Versions/3.7/lib/python3.7/site-packages/ccdproc/image_collection.py:546: UserWarning: Header from file &quot;/Users/jzamorano/Desktop/NOT_2008/N1/zt_ALrd120045.fits&quot; contains multiple entries for &quot;mjd-obs&quot;, the pair &quot;mjd-obs=54568.82068287&quot; will be ignored.
  UserWarning)
/Library/Frameworks/Python.framework/Versions/3.7/lib/python3.7/site-packages/ccdproc/image_collection.py:546: UserWarning: Header from file &quot;/Users/jzamorano/Desktop/NOT_2008/N1/zt_ALrd120046.fits&quot; contains multiple entries for &quot;mjd-obs&quot;, the pair &quot;mjd-obs=54568.821689815&quot; will be ignored.
  UserWarning)
/Library/Frameworks/Python.framework/Versions/3.7/lib/python3.7/site-packages/ccdproc/image_collection.py:546: UserWarning: Header from file &quot;/Users/jzamorano/Desktop/NOT_2008/N1/zt_ALrd120047.fits&quot; contains multiple entries for &quot;mjd-obs&quot;, the pair &quot;mjd-obs=54568.822719907&quot; will be ignored.
  UserWarning)
/Library/Frameworks/Python.framework/Versions/3.7/lib/python3.7/site-packages/ccdproc/image_collection.py:546: UserWarning: Header from file &quot;/Users/jzamorano/Desktop/NOT_2008/N1/zt_ALrd120048.fits&quot; contains multiple entries for &quot;mjd-obs&quot;, the pair &quot;mjd-obs=54568.82375&quot; will be ignored.
  UserWarning)
/Library/Frameworks/Python.framework/Versions/3.7/lib/python3.7/site-packages/ccdproc/image_collection.py:546: UserWarning: Header from file &quot;/Users/jzamorano/Desktop/NOT_2008/N1/zt_ALrd120049.fits&quot; contains multiple entries for &quot;mjd-obs&quot;, the pair &quot;mjd-obs=54568.824826389&quot; will be ignored.
  UserWarning)
/Library/Frameworks/Python.framework/Versions/3.7/lib/python3.7/site-packages/ccdproc/image_collection.py:546: UserWarning: Header from file &quot;/Users/jzamorano/Desktop/NOT_2008/N1/zt_ALrd120050.fits&quot; contains multiple entries for &quot;mjd-obs&quot;, the pair &quot;mjd-obs=54568.8259375&quot; will be ignored.
  UserWarning)
/Library/Frameworks/Python.framework/Versions/3.7/lib/python3.7/site-packages/ccdproc/image_collection.py:546: UserWarning: Header from file &quot;/Users/jzamorano/Desktop/NOT_2008/N1/zt_ALrd120051.fits&quot; contains multiple entries for &quot;mjd-obs&quot;, the pair &quot;mjd-obs=54568.827118056&quot; will be ignored.
  UserWarning)
/Library/Frameworks/Python.framework/Versions/3.7/lib/python3.7/site-packages/ccdproc/image_collection.py:546: UserWarning: Header from file &quot;/Users/jzamorano/Desktop/NOT_2008/N1/zt_ALrd120052.fits&quot; contains multiple entries for &quot;mjd-obs&quot;, the pair &quot;mjd-obs=54568.828298611&quot; will be ignored.
  UserWarning)
/Library/Frameworks/Python.framework/Versions/3.7/lib/python3.7/site-packages/ccdproc/image_collection.py:546: UserWarning: Header from file &quot;/Users/jzamorano/Desktop/NOT_2008/N1/zt_ALrd120053.fits&quot; contains multiple entries for &quot;mjd-obs&quot;, the pair &quot;mjd-obs=54568.829583333&quot; will be ignored.
  UserWarning)
/Library/Frameworks/Python.framework/Versions/3.7/lib/python3.7/site-packages/ccdproc/image_collection.py:546: UserWarning: Header from file &quot;/Users/jzamorano/Desktop/NOT_2008/N1/zt_ALrd120054.fits&quot; contains multiple entries for &quot;mjd-obs&quot;, the pair &quot;mjd-obs=54568.833946759&quot; will be ignored.
  UserWarning)
/Library/Frameworks/Python.framework/Versions/3.7/lib/python3.7/site-packages/ccdproc/image_collection.py:546: UserWarning: Header from file &quot;/Users/jzamorano/Desktop/NOT_2008/N1/zt_ALrd120055.fits&quot; contains multiple entries for &quot;mjd-obs&quot;, the pair &quot;mjd-obs=54568.835046296&quot; will be ignored.
  UserWarning)
/Library/Frameworks/Python.framework/Versions/3.7/lib/python3.7/site-packages/ccdproc/image_collection.py:546: UserWarning: Header from file &quot;/Users/jzamorano/Desktop/NOT_2008/N1/zt_ALrd120056.fits&quot; contains multiple entries for &quot;mjd-obs&quot;, the pair &quot;mjd-obs=54568.836273148&quot; will be ignored.
  UserWarning)
/Library/Frameworks/Python.framework/Versions/3.7/lib/python3.7/site-packages/ccdproc/image_collection.py:546: UserWarning: Header from file &quot;/Users/jzamorano/Desktop/NOT_2008/N1/zt_ALrd120057.fits&quot; contains multiple entries for &quot;mjd-obs&quot;, the pair &quot;mjd-obs=54568.837627315&quot; will be ignored.
  UserWarning)
/Library/Frameworks/Python.framework/Versions/3.7/lib/python3.7/site-packages/ccdproc/image_collection.py:546: UserWarning: Header from file &quot;/Users/jzamorano/Desktop/NOT_2008/N1/zt_ALrd120058.fits&quot; contains multiple entries for &quot;mjd-obs&quot;, the pair &quot;mjd-obs=54568.838645833&quot; will be ignored.
  UserWarning)
/Library/Frameworks/Python.framework/Versions/3.7/lib/python3.7/site-packages/ccdproc/image_collection.py:546: UserWarning: Header from file &quot;/Users/jzamorano/Desktop/NOT_2008/N1/zt_ALrd120059.fits&quot; contains multiple entries for &quot;mjd-obs&quot;, the pair &quot;mjd-obs=54568.839664352&quot; will be ignored.
  UserWarning)
/Library/Frameworks/Python.framework/Versions/3.7/lib/python3.7/site-packages/ccdproc/image_collection.py:546: UserWarning: Header from file &quot;/Users/jzamorano/Desktop/NOT_2008/N1/zt_ALrd120060.fits&quot; contains multiple entries for &quot;mjd-obs&quot;, the pair &quot;mjd-obs=54568.840694444&quot; will be ignored.
  UserWarning)
/Library/Frameworks/Python.framework/Versions/3.7/lib/python3.7/site-packages/ccdproc/image_collection.py:546: UserWarning: Header from file &quot;/Users/jzamorano/Desktop/NOT_2008/N1/zt_ALrd120061.fits&quot; contains multiple entries for &quot;mjd-obs&quot;, the pair &quot;mjd-obs=54568.841747685&quot; will be ignored.
  UserWarning)
/Library/Frameworks/Python.framework/Versions/3.7/lib/python3.7/site-packages/ccdproc/image_collection.py:546: UserWarning: Header from file &quot;/Users/jzamorano/Desktop/NOT_2008/N1/zt_ALrd120062.fits&quot; contains multiple entries for &quot;mjd-obs&quot;, the pair &quot;mjd-obs=54568.842858796&quot; will be ignored.
  UserWarning)
/Library/Frameworks/Python.framework/Versions/3.7/lib/python3.7/site-packages/ccdproc/image_collection.py:546: UserWarning: Header from file &quot;/Users/jzamorano/Desktop/NOT_2008/N1/zt_ALrd120064.fits&quot; contains multiple entries for &quot;mjd-obs&quot;, the pair &quot;mjd-obs=54568.84943287&quot; will be ignored.
  UserWarning)
/Library/Frameworks/Python.framework/Versions/3.7/lib/python3.7/site-packages/ccdproc/image_collection.py:546: UserWarning: Header from file &quot;/Users/jzamorano/Desktop/NOT_2008/N1/zt_ALrd120065.fits&quot; contains multiple entries for &quot;mjd-obs&quot;, the pair &quot;mjd-obs=54568.851666667&quot; will be ignored.
  UserWarning)
/Library/Frameworks/Python.framework/Versions/3.7/lib/python3.7/site-packages/ccdproc/image_collection.py:546: UserWarning: Header from file &quot;/Users/jzamorano/Desktop/NOT_2008/N1/zt_ALrd120066.fits&quot; contains multiple entries for &quot;mjd-obs&quot;, the pair &quot;mjd-obs=54568.853553241&quot; will be ignored.
  UserWarning)
/Library/Frameworks/Python.framework/Versions/3.7/lib/python3.7/site-packages/ccdproc/image_collection.py:546: UserWarning: Header from file &quot;/Users/jzamorano/Desktop/NOT_2008/N1/zt_ALrd120067.fits&quot; contains multiple entries for &quot;mjd-obs&quot;, the pair &quot;mjd-obs=54568.855520833&quot; will be ignored.
  UserWarning)
/Library/Frameworks/Python.framework/Versions/3.7/lib/python3.7/site-packages/ccdproc/image_collection.py:546: UserWarning: Header from file &quot;/Users/jzamorano/Desktop/NOT_2008/N1/zt_ALrd120068.fits&quot; contains multiple entries for &quot;mjd-obs&quot;, the pair &quot;mjd-obs=54568.856979167&quot; will be ignored.
  UserWarning)
/Library/Frameworks/Python.framework/Versions/3.7/lib/python3.7/site-packages/ccdproc/image_collection.py:546: UserWarning: Header from file &quot;/Users/jzamorano/Desktop/NOT_2008/N1/zt_ALrd120069.fits&quot; contains multiple entries for &quot;mjd-obs&quot;, the pair &quot;mjd-obs=54568.859236111&quot; will be ignored.
  UserWarning)
/Library/Frameworks/Python.framework/Versions/3.7/lib/python3.7/site-packages/ccdproc/image_collection.py:546: UserWarning: Header from file &quot;/Users/jzamorano/Desktop/NOT_2008/N1/zt_ALrd120070.fits&quot; contains multiple entries for &quot;mjd-obs&quot;, the pair &quot;mjd-obs=54568.860694444&quot; will be ignored.
  UserWarning)
/Library/Frameworks/Python.framework/Versions/3.7/lib/python3.7/site-packages/ccdproc/image_collection.py:546: UserWarning: Header from file &quot;/Users/jzamorano/Desktop/NOT_2008/N1/zt_ALrd120071.fits&quot; contains multiple entries for &quot;mjd-obs&quot;, the pair &quot;mjd-obs=54568.862476852&quot; will be ignored.
  UserWarning)
/Library/Frameworks/Python.framework/Versions/3.7/lib/python3.7/site-packages/ccdproc/image_collection.py:546: UserWarning: Header from file &quot;/Users/jzamorano/Desktop/NOT_2008/N1/zt_ALrd120072.fits&quot; contains multiple entries for &quot;mjd-obs&quot;, the pair &quot;mjd-obs=54568.864236111&quot; will be ignored.
  UserWarning)
/Library/Frameworks/Python.framework/Versions/3.7/lib/python3.7/site-packages/ccdproc/image_collection.py:546: UserWarning: Header from file &quot;/Users/jzamorano/Desktop/NOT_2008/N1/zt_ALrd120073.fits&quot; contains multiple entries for &quot;mjd-obs&quot;, the pair &quot;mjd-obs=54568.866678241&quot; will be ignored.
  UserWarning)
/Library/Frameworks/Python.framework/Versions/3.7/lib/python3.7/site-packages/ccdproc/image_collection.py:546: UserWarning: Header from file &quot;/Users/jzamorano/Desktop/NOT_2008/N1/zt_ALrd120074.fits&quot; contains multiple entries for &quot;mjd-obs&quot;, the pair &quot;mjd-obs=54568.868171296&quot; will be ignored.
  UserWarning)
/Library/Frameworks/Python.framework/Versions/3.7/lib/python3.7/site-packages/ccdproc/image_collection.py:546: UserWarning: Header from file &quot;/Users/jzamorano/Desktop/NOT_2008/N1/zt_ALrd120075.fits&quot; contains multiple entries for &quot;mjd-obs&quot;, the pair &quot;mjd-obs=54568.86994213&quot; will be ignored.
  UserWarning)
/Library/Frameworks/Python.framework/Versions/3.7/lib/python3.7/site-packages/ccdproc/image_collection.py:546: UserWarning: Header from file &quot;/Users/jzamorano/Desktop/NOT_2008/N1/zt_ALrd120076.fits&quot; contains multiple entries for &quot;mjd-obs&quot;, the pair &quot;mjd-obs=54568.871597222&quot; will be ignored.
  UserWarning)
/Library/Frameworks/Python.framework/Versions/3.7/lib/python3.7/site-packages/ccdproc/image_collection.py:546: UserWarning: Header from file &quot;/Users/jzamorano/Desktop/NOT_2008/N1/zt_ALrd120077.fits&quot; contains multiple entries for &quot;mjd-obs&quot;, the pair &quot;mjd-obs=54568.873634259&quot; will be ignored.
  UserWarning)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/Library/Frameworks/Python.framework/Versions/3.7/lib/python3.7/site-packages/ccdproc/image_collection.py:546: UserWarning: Header from file &quot;/Users/jzamorano/Desktop/NOT_2008/N1/zt_ALrd120078.fits&quot; contains multiple entries for &quot;mjd-obs&quot;, the pair &quot;mjd-obs=54568.874664352&quot; will be ignored.
  UserWarning)
/Library/Frameworks/Python.framework/Versions/3.7/lib/python3.7/site-packages/ccdproc/image_collection.py:546: UserWarning: Header from file &quot;/Users/jzamorano/Desktop/NOT_2008/N1/zt_ALrd120079.fits&quot; contains multiple entries for &quot;mjd-obs&quot;, the pair &quot;mjd-obs=54568.876099537&quot; will be ignored.
  UserWarning)
/Library/Frameworks/Python.framework/Versions/3.7/lib/python3.7/site-packages/ccdproc/image_collection.py:546: UserWarning: Header from file &quot;/Users/jzamorano/Desktop/NOT_2008/N1/zt_ALrd120080.fits&quot; contains multiple entries for &quot;mjd-obs&quot;, the pair &quot;mjd-obs=54568.877708333&quot; will be ignored.
  UserWarning)
/Library/Frameworks/Python.framework/Versions/3.7/lib/python3.7/site-packages/ccdproc/image_collection.py:546: UserWarning: Header from file &quot;/Users/jzamorano/Desktop/NOT_2008/N1/zt_ALrd120081.fits&quot; contains multiple entries for &quot;mjd-obs&quot;, the pair &quot;mjd-obs=54568.880833333&quot; will be ignored.
  UserWarning)
/Library/Frameworks/Python.framework/Versions/3.7/lib/python3.7/site-packages/ccdproc/image_collection.py:546: UserWarning: Header from file &quot;/Users/jzamorano/Desktop/NOT_2008/N1/zt_ALrd120082.fits&quot; contains multiple entries for &quot;mjd-obs&quot;, the pair &quot;mjd-obs=54568.882847222&quot; will be ignored.
  UserWarning)
/Library/Frameworks/Python.framework/Versions/3.7/lib/python3.7/site-packages/ccdproc/image_collection.py:546: UserWarning: Header from file &quot;/Users/jzamorano/Desktop/NOT_2008/N1/zt_ALrd120083.fits&quot; contains multiple entries for &quot;mjd-obs&quot;, the pair &quot;mjd-obs=54568.884178241&quot; will be ignored.
  UserWarning)
/Library/Frameworks/Python.framework/Versions/3.7/lib/python3.7/site-packages/ccdproc/image_collection.py:546: UserWarning: Header from file &quot;/Users/jzamorano/Desktop/NOT_2008/N1/zt_ALrd120084.fits&quot; contains multiple entries for &quot;mjd-obs&quot;, the pair &quot;mjd-obs=54568.885509259&quot; will be ignored.
  UserWarning)
/Library/Frameworks/Python.framework/Versions/3.7/lib/python3.7/site-packages/ccdproc/image_collection.py:546: UserWarning: Header from file &quot;/Users/jzamorano/Desktop/NOT_2008/N1/zt_ALrd120085.fits&quot; contains multiple entries for &quot;mjd-obs&quot;, the pair &quot;mjd-obs=54568.88650463&quot; will be ignored.
  UserWarning)
/Library/Frameworks/Python.framework/Versions/3.7/lib/python3.7/site-packages/ccdproc/image_collection.py:546: UserWarning: Header from file &quot;/Users/jzamorano/Desktop/NOT_2008/N1/zt_ALrd120086.fits&quot; contains multiple entries for &quot;mjd-obs&quot;, the pair &quot;mjd-obs=54568.88787037&quot; will be ignored.
  UserWarning)
/Library/Frameworks/Python.framework/Versions/3.7/lib/python3.7/site-packages/ccdproc/image_collection.py:546: UserWarning: Header from file &quot;/Users/jzamorano/Desktop/NOT_2008/N1/zt_ALrd120087.fits&quot; contains multiple entries for &quot;mjd-obs&quot;, the pair &quot;mjd-obs=54568.889027778&quot; will be ignored.
  UserWarning)
/Library/Frameworks/Python.framework/Versions/3.7/lib/python3.7/site-packages/ccdproc/image_collection.py:546: UserWarning: Header from file &quot;/Users/jzamorano/Desktop/NOT_2008/N1/zt_ALrd120088.fits&quot; contains multiple entries for &quot;mjd-obs&quot;, the pair &quot;mjd-obs=54568.890474537&quot; will be ignored.
  UserWarning)
/Library/Frameworks/Python.framework/Versions/3.7/lib/python3.7/site-packages/ccdproc/image_collection.py:546: UserWarning: Header from file &quot;/Users/jzamorano/Desktop/NOT_2008/N1/zt_ALrd120089.fits&quot; contains multiple entries for &quot;mjd-obs&quot;, the pair &quot;mjd-obs=54568.894490741&quot; will be ignored.
  UserWarning)
/Library/Frameworks/Python.framework/Versions/3.7/lib/python3.7/site-packages/ccdproc/image_collection.py:546: UserWarning: Header from file &quot;/Users/jzamorano/Desktop/NOT_2008/N1/zt_ALrd120090.fits&quot; contains multiple entries for &quot;mjd-obs&quot;, the pair &quot;mjd-obs=54568.899074074&quot; will be ignored.
  UserWarning)
/Library/Frameworks/Python.framework/Versions/3.7/lib/python3.7/site-packages/ccdproc/image_collection.py:546: UserWarning: Header from file &quot;/Users/jzamorano/Desktop/NOT_2008/N1/zt_ALrd120091.fits&quot; contains multiple entries for &quot;mjd-obs&quot;, the pair &quot;mjd-obs=54568.903657407&quot; will be ignored.
  UserWarning)
/Library/Frameworks/Python.framework/Versions/3.7/lib/python3.7/site-packages/ccdproc/image_collection.py:546: UserWarning: Header from file &quot;/Users/jzamorano/Desktop/NOT_2008/N1/zt_ALrd120092.fits&quot; contains multiple entries for &quot;mjd-obs&quot;, the pair &quot;mjd-obs=54568.908136574&quot; will be ignored.
  UserWarning)
/Library/Frameworks/Python.framework/Versions/3.7/lib/python3.7/site-packages/ccdproc/image_collection.py:546: UserWarning: Header from file &quot;/Users/jzamorano/Desktop/NOT_2008/N1/zt_ALrd120093.fits&quot; contains multiple entries for &quot;mjd-obs&quot;, the pair &quot;mjd-obs=54568.91962963&quot; will be ignored.
  UserWarning)
/Library/Frameworks/Python.framework/Versions/3.7/lib/python3.7/site-packages/ccdproc/image_collection.py:546: UserWarning: Header from file &quot;/Users/jzamorano/Desktop/NOT_2008/N1/zt_ALrd120094.fits&quot; contains multiple entries for &quot;mjd-obs&quot;, the pair &quot;mjd-obs=54568.931168981&quot; will be ignored.
  UserWarning)
/Library/Frameworks/Python.framework/Versions/3.7/lib/python3.7/site-packages/ccdproc/image_collection.py:546: UserWarning: Header from file &quot;/Users/jzamorano/Desktop/NOT_2008/N1/zt_ALrd120095.fits&quot; contains multiple entries for &quot;mjd-obs&quot;, the pair &quot;mjd-obs=54568.942696759&quot; will be ignored.
  UserWarning)
/Library/Frameworks/Python.framework/Versions/3.7/lib/python3.7/site-packages/ccdproc/image_collection.py:546: UserWarning: Header from file &quot;/Users/jzamorano/Desktop/NOT_2008/N1/zt_ALrd120096.fits&quot; contains multiple entries for &quot;mjd-obs&quot;, the pair &quot;mjd-obs=54568.94724537&quot; will be ignored.
  UserWarning)
/Library/Frameworks/Python.framework/Versions/3.7/lib/python3.7/site-packages/ccdproc/image_collection.py:546: UserWarning: Header from file &quot;/Users/jzamorano/Desktop/NOT_2008/N1/zt_ALrd120097.fits&quot; contains multiple entries for &quot;mjd-obs&quot;, the pair &quot;mjd-obs=54568.951770833&quot; will be ignored.
  UserWarning)
/Library/Frameworks/Python.framework/Versions/3.7/lib/python3.7/site-packages/ccdproc/image_collection.py:546: UserWarning: Header from file &quot;/Users/jzamorano/Desktop/NOT_2008/N1/zt_ALrd120098.fits&quot; contains multiple entries for &quot;mjd-obs&quot;, the pair &quot;mjd-obs=54568.958715278&quot; will be ignored.
  UserWarning)
/Library/Frameworks/Python.framework/Versions/3.7/lib/python3.7/site-packages/ccdproc/image_collection.py:546: UserWarning: Header from file &quot;/Users/jzamorano/Desktop/NOT_2008/N1/zt_ALrd120099.fits&quot; contains multiple entries for &quot;mjd-obs&quot;, the pair &quot;mjd-obs=54568.970196759&quot; will be ignored.
  UserWarning)
/Library/Frameworks/Python.framework/Versions/3.7/lib/python3.7/site-packages/ccdproc/image_collection.py:546: UserWarning: Header from file &quot;/Users/jzamorano/Desktop/NOT_2008/N1/zt_ALrd120100.fits&quot; contains multiple entries for &quot;mjd-obs&quot;, the pair &quot;mjd-obs=54568.981689815&quot; will be ignored.
  UserWarning)
/Library/Frameworks/Python.framework/Versions/3.7/lib/python3.7/site-packages/ccdproc/image_collection.py:546: UserWarning: Header from file &quot;/Users/jzamorano/Desktop/NOT_2008/N1/zt_ALrd120101.fits&quot; contains multiple entries for &quot;mjd-obs&quot;, the pair &quot;mjd-obs=54568.993425926&quot; will be ignored.
  UserWarning)
/Library/Frameworks/Python.framework/Versions/3.7/lib/python3.7/site-packages/ccdproc/image_collection.py:546: UserWarning: Header from file &quot;/Users/jzamorano/Desktop/NOT_2008/N1/zt_ALrd120102.fits&quot; contains multiple entries for &quot;mjd-obs&quot;, the pair &quot;mjd-obs=54568.996469907&quot; will be ignored.
  UserWarning)
/Library/Frameworks/Python.framework/Versions/3.7/lib/python3.7/site-packages/ccdproc/image_collection.py:546: UserWarning: Header from file &quot;/Users/jzamorano/Desktop/NOT_2008/N1/zt_ALrd120103.fits&quot; contains multiple entries for &quot;mjd-obs&quot;, the pair &quot;mjd-obs=54569.00099537&quot; will be ignored.
  UserWarning)
/Library/Frameworks/Python.framework/Versions/3.7/lib/python3.7/site-packages/ccdproc/image_collection.py:546: UserWarning: Header from file &quot;/Users/jzamorano/Desktop/NOT_2008/N1/zt_ALrd120104.fits&quot; contains multiple entries for &quot;mjd-obs&quot;, the pair &quot;mjd-obs=54569.005509259&quot; will be ignored.
  UserWarning)
/Library/Frameworks/Python.framework/Versions/3.7/lib/python3.7/site-packages/ccdproc/image_collection.py:546: UserWarning: Header from file &quot;/Users/jzamorano/Desktop/NOT_2008/N1/zt_ALrd120105.fits&quot; contains multiple entries for &quot;mjd-obs&quot;, the pair &quot;mjd-obs=54569.010266204&quot; will be ignored.
  UserWarning)
/Library/Frameworks/Python.framework/Versions/3.7/lib/python3.7/site-packages/ccdproc/image_collection.py:546: UserWarning: Header from file &quot;/Users/jzamorano/Desktop/NOT_2008/N1/zt_ALrd120106.fits&quot; contains multiple entries for &quot;mjd-obs&quot;, the pair &quot;mjd-obs=54569.014803241&quot; will be ignored.
  UserWarning)
/Library/Frameworks/Python.framework/Versions/3.7/lib/python3.7/site-packages/ccdproc/image_collection.py:546: UserWarning: Header from file &quot;/Users/jzamorano/Desktop/NOT_2008/N1/zt_ALrd120107.fits&quot; contains multiple entries for &quot;mjd-obs&quot;, the pair &quot;mjd-obs=54569.019293981&quot; will be ignored.
  UserWarning)
/Library/Frameworks/Python.framework/Versions/3.7/lib/python3.7/site-packages/ccdproc/image_collection.py:546: UserWarning: Header from file &quot;/Users/jzamorano/Desktop/NOT_2008/N1/zt_ALrd120108.fits&quot; contains multiple entries for &quot;mjd-obs&quot;, the pair &quot;mjd-obs=54569.030763889&quot; will be ignored.
  UserWarning)
/Library/Frameworks/Python.framework/Versions/3.7/lib/python3.7/site-packages/ccdproc/image_collection.py:546: UserWarning: Header from file &quot;/Users/jzamorano/Desktop/NOT_2008/N1/zt_ALrd120109.fits&quot; contains multiple entries for &quot;mjd-obs&quot;, the pair &quot;mjd-obs=54569.042233796&quot; will be ignored.
  UserWarning)
/Library/Frameworks/Python.framework/Versions/3.7/lib/python3.7/site-packages/ccdproc/image_collection.py:546: UserWarning: Header from file &quot;/Users/jzamorano/Desktop/NOT_2008/N1/zt_ALrd120110.fits&quot; contains multiple entries for &quot;mjd-obs&quot;, the pair &quot;mjd-obs=54569.054675926&quot; will be ignored.
  UserWarning)
/Library/Frameworks/Python.framework/Versions/3.7/lib/python3.7/site-packages/ccdproc/image_collection.py:546: UserWarning: Header from file &quot;/Users/jzamorano/Desktop/NOT_2008/N1/zt_ALrd120111.fits&quot; contains multiple entries for &quot;mjd-obs&quot;, the pair &quot;mjd-obs=54569.059236111&quot; will be ignored.
  UserWarning)
/Library/Frameworks/Python.framework/Versions/3.7/lib/python3.7/site-packages/ccdproc/image_collection.py:546: UserWarning: Header from file &quot;/Users/jzamorano/Desktop/NOT_2008/N1/zt_ALrd120112.fits&quot; contains multiple entries for &quot;mjd-obs&quot;, the pair &quot;mjd-obs=54569.063715278&quot; will be ignored.
  UserWarning)
/Library/Frameworks/Python.framework/Versions/3.7/lib/python3.7/site-packages/ccdproc/image_collection.py:546: UserWarning: Header from file &quot;/Users/jzamorano/Desktop/NOT_2008/N1/zt_ALrd120113.fits&quot; contains multiple entries for &quot;mjd-obs&quot;, the pair &quot;mjd-obs=54569.069050926&quot; will be ignored.
  UserWarning)
/Library/Frameworks/Python.framework/Versions/3.7/lib/python3.7/site-packages/ccdproc/image_collection.py:546: UserWarning: Header from file &quot;/Users/jzamorano/Desktop/NOT_2008/N1/zt_ALrd120114.fits&quot; contains multiple entries for &quot;mjd-obs&quot;, the pair &quot;mjd-obs=54569.080486111&quot; will be ignored.
  UserWarning)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/Library/Frameworks/Python.framework/Versions/3.7/lib/python3.7/site-packages/ccdproc/image_collection.py:546: UserWarning: Header from file &quot;/Users/jzamorano/Desktop/NOT_2008/N1/zt_ALrd120115.fits&quot; contains multiple entries for &quot;mjd-obs&quot;, the pair &quot;mjd-obs=54569.091967593&quot; will be ignored.
  UserWarning)
/Library/Frameworks/Python.framework/Versions/3.7/lib/python3.7/site-packages/ccdproc/image_collection.py:546: UserWarning: Header from file &quot;/Users/jzamorano/Desktop/NOT_2008/N1/zt_ALrd120116.fits&quot; contains multiple entries for &quot;mjd-obs&quot;, the pair &quot;mjd-obs=54569.103900463&quot; will be ignored.
  UserWarning)
/Library/Frameworks/Python.framework/Versions/3.7/lib/python3.7/site-packages/ccdproc/image_collection.py:546: UserWarning: Header from file &quot;/Users/jzamorano/Desktop/NOT_2008/N1/zt_ALrd120117.fits&quot; contains multiple entries for &quot;mjd-obs&quot;, the pair &quot;mjd-obs=54569.108483796&quot; will be ignored.
  UserWarning)
/Library/Frameworks/Python.framework/Versions/3.7/lib/python3.7/site-packages/ccdproc/image_collection.py:546: UserWarning: Header from file &quot;/Users/jzamorano/Desktop/NOT_2008/N1/zt_ALrd120118.fits&quot; contains multiple entries for &quot;mjd-obs&quot;, the pair &quot;mjd-obs=54569.112997685&quot; will be ignored.
  UserWarning)
/Library/Frameworks/Python.framework/Versions/3.7/lib/python3.7/site-packages/ccdproc/image_collection.py:546: UserWarning: Header from file &quot;/Users/jzamorano/Desktop/NOT_2008/N1/zt_ALrd120119.fits&quot; contains multiple entries for &quot;mjd-obs&quot;, the pair &quot;mjd-obs=54569.1175&quot; will be ignored.
  UserWarning)
/Library/Frameworks/Python.framework/Versions/3.7/lib/python3.7/site-packages/ccdproc/image_collection.py:546: UserWarning: Header from file &quot;/Users/jzamorano/Desktop/NOT_2008/N1/zt_ALrd120120.fits&quot; contains multiple entries for &quot;mjd-obs&quot;, the pair &quot;mjd-obs=54569.128935185&quot; will be ignored.
  UserWarning)
/Library/Frameworks/Python.framework/Versions/3.7/lib/python3.7/site-packages/ccdproc/image_collection.py:546: UserWarning: Header from file &quot;/Users/jzamorano/Desktop/NOT_2008/N1/zt_ALrd120121.fits&quot; contains multiple entries for &quot;mjd-obs&quot;, the pair &quot;mjd-obs=54569.140416667&quot; will be ignored.
  UserWarning)
/Library/Frameworks/Python.framework/Versions/3.7/lib/python3.7/site-packages/ccdproc/image_collection.py:546: UserWarning: Header from file &quot;/Users/jzamorano/Desktop/NOT_2008/N1/zt_ALrd120122.fits&quot; contains multiple entries for &quot;mjd-obs&quot;, the pair &quot;mjd-obs=54569.154814815&quot; will be ignored.
  UserWarning)
/Library/Frameworks/Python.framework/Versions/3.7/lib/python3.7/site-packages/ccdproc/image_collection.py:546: UserWarning: Header from file &quot;/Users/jzamorano/Desktop/NOT_2008/N1/zt_ALrd120123.fits&quot; contains multiple entries for &quot;mjd-obs&quot;, the pair &quot;mjd-obs=54569.157916667&quot; will be ignored.
  UserWarning)
/Library/Frameworks/Python.framework/Versions/3.7/lib/python3.7/site-packages/ccdproc/image_collection.py:546: UserWarning: Header from file &quot;/Users/jzamorano/Desktop/NOT_2008/N1/zt_ALrd120124.fits&quot; contains multiple entries for &quot;mjd-obs&quot;, the pair &quot;mjd-obs=54569.162199074&quot; will be ignored.
  UserWarning)
/Library/Frameworks/Python.framework/Versions/3.7/lib/python3.7/site-packages/ccdproc/image_collection.py:546: UserWarning: Header from file &quot;/Users/jzamorano/Desktop/NOT_2008/N1/zt_ALrd120125.fits&quot; contains multiple entries for &quot;mjd-obs&quot;, the pair &quot;mjd-obs=54569.166805556&quot; will be ignored.
  UserWarning)
/Library/Frameworks/Python.framework/Versions/3.7/lib/python3.7/site-packages/ccdproc/image_collection.py:546: UserWarning: Header from file &quot;/Users/jzamorano/Desktop/NOT_2008/N1/zt_ALrd120126.fits&quot; contains multiple entries for &quot;mjd-obs&quot;, the pair &quot;mjd-obs=54569.171759259&quot; will be ignored.
  UserWarning)
/Library/Frameworks/Python.framework/Versions/3.7/lib/python3.7/site-packages/ccdproc/image_collection.py:546: UserWarning: Header from file &quot;/Users/jzamorano/Desktop/NOT_2008/N1/zt_ALrd120127.fits&quot; contains multiple entries for &quot;mjd-obs&quot;, the pair &quot;mjd-obs=54569.174421296&quot; will be ignored.
  UserWarning)
/Library/Frameworks/Python.framework/Versions/3.7/lib/python3.7/site-packages/ccdproc/image_collection.py:546: UserWarning: Header from file &quot;/Users/jzamorano/Desktop/NOT_2008/N1/zt_ALrd120128.fits&quot; contains multiple entries for &quot;mjd-obs&quot;, the pair &quot;mjd-obs=54569.177731481&quot; will be ignored.
  UserWarning)
/Library/Frameworks/Python.framework/Versions/3.7/lib/python3.7/site-packages/ccdproc/image_collection.py:546: UserWarning: Header from file &quot;/Users/jzamorano/Desktop/NOT_2008/N1/zt_ALrd120129.fits&quot; contains multiple entries for &quot;mjd-obs&quot;, the pair &quot;mjd-obs=54569.180300926&quot; will be ignored.
  UserWarning)
/Library/Frameworks/Python.framework/Versions/3.7/lib/python3.7/site-packages/ccdproc/image_collection.py:546: UserWarning: Header from file &quot;/Users/jzamorano/Desktop/NOT_2008/N1/zt_ALrd120130.fits&quot; contains multiple entries for &quot;mjd-obs&quot;, the pair &quot;mjd-obs=54569.182604167&quot; will be ignored.
  UserWarning)
/Library/Frameworks/Python.framework/Versions/3.7/lib/python3.7/site-packages/ccdproc/image_collection.py:546: UserWarning: Header from file &quot;/Users/jzamorano/Desktop/NOT_2008/N1/zt_ALrd120131.fits&quot; contains multiple entries for &quot;mjd-obs&quot;, the pair &quot;mjd-obs=54569.185219907&quot; will be ignored.
  UserWarning)
/Library/Frameworks/Python.framework/Versions/3.7/lib/python3.7/site-packages/ccdproc/image_collection.py:546: UserWarning: Header from file &quot;/Users/jzamorano/Desktop/NOT_2008/N1/zt_ALrd120132.fits&quot; contains multiple entries for &quot;mjd-obs&quot;, the pair &quot;mjd-obs=54569.188136574&quot; will be ignored.
  UserWarning)
/Library/Frameworks/Python.framework/Versions/3.7/lib/python3.7/site-packages/ccdproc/image_collection.py:546: UserWarning: Header from file &quot;/Users/jzamorano/Desktop/NOT_2008/N1/zt_ALrd120133.fits&quot; contains multiple entries for &quot;mjd-obs&quot;, the pair &quot;mjd-obs=54569.190532407&quot; will be ignored.
  UserWarning)
/Library/Frameworks/Python.framework/Versions/3.7/lib/python3.7/site-packages/ccdproc/image_collection.py:546: UserWarning: Header from file &quot;/Users/jzamorano/Desktop/NOT_2008/N1/zt_ALrd120134.fits&quot; contains multiple entries for &quot;mjd-obs&quot;, the pair &quot;mjd-obs=54569.192858796&quot; will be ignored.
  UserWarning)
/Library/Frameworks/Python.framework/Versions/3.7/lib/python3.7/site-packages/ccdproc/image_collection.py:546: UserWarning: Header from file &quot;/Users/jzamorano/Desktop/NOT_2008/N1/zt_ALrd120135.fits&quot; contains multiple entries for &quot;mjd-obs&quot;, the pair &quot;mjd-obs=54569.197407407&quot; will be ignored.
  UserWarning)
/Library/Frameworks/Python.framework/Versions/3.7/lib/python3.7/site-packages/ccdproc/image_collection.py:546: UserWarning: Header from file &quot;/Users/jzamorano/Desktop/NOT_2008/N1/zt_ALrd120136.fits&quot; contains multiple entries for &quot;mjd-obs&quot;, the pair &quot;mjd-obs=54569.208854167&quot; will be ignored.
  UserWarning)
/Library/Frameworks/Python.framework/Versions/3.7/lib/python3.7/site-packages/ccdproc/image_collection.py:546: UserWarning: Header from file &quot;/Users/jzamorano/Desktop/NOT_2008/N1/zt_ALrd120137.fits&quot; contains multiple entries for &quot;mjd-obs&quot;, the pair &quot;mjd-obs=54569.211412037&quot; will be ignored.
  UserWarning)
/Library/Frameworks/Python.framework/Versions/3.7/lib/python3.7/site-packages/ccdproc/image_collection.py:546: UserWarning: Header from file &quot;/Users/jzamorano/Desktop/NOT_2008/N1/zt_ALrd120138.fits&quot; contains multiple entries for &quot;mjd-obs&quot;, the pair &quot;mjd-obs=54569.213298611&quot; will be ignored.
  UserWarning)
/Library/Frameworks/Python.framework/Versions/3.7/lib/python3.7/site-packages/ccdproc/image_collection.py:546: UserWarning: Header from file &quot;/Users/jzamorano/Desktop/NOT_2008/N1/zt_ALrd120139.fits&quot; contains multiple entries for &quot;mjd-obs&quot;, the pair &quot;mjd-obs=54569.214849537&quot; will be ignored.
  UserWarning)
/Library/Frameworks/Python.framework/Versions/3.7/lib/python3.7/site-packages/ccdproc/image_collection.py:546: UserWarning: Header from file &quot;/Users/jzamorano/Desktop/NOT_2008/N1/zt_ALrd120140.fits&quot; contains multiple entries for &quot;mjd-obs&quot;, the pair &quot;mjd-obs=54569.216631944&quot; will be ignored.
  UserWarning)
/Library/Frameworks/Python.framework/Versions/3.7/lib/python3.7/site-packages/ccdproc/image_collection.py:546: UserWarning: Header from file &quot;/Users/jzamorano/Desktop/NOT_2008/N1/zt_ALrd120141.fits&quot; contains multiple entries for &quot;mjd-obs&quot;, the pair &quot;mjd-obs=54569.221400463&quot; will be ignored.
  UserWarning)
/Library/Frameworks/Python.framework/Versions/3.7/lib/python3.7/site-packages/ccdproc/image_collection.py:546: UserWarning: Header from file &quot;/Users/jzamorano/Desktop/NOT_2008/N1/zt_ALrd120142.fits&quot; contains multiple entries for &quot;mjd-obs&quot;, the pair &quot;mjd-obs=54569.226064815&quot; will be ignored.
  UserWarning)
/Library/Frameworks/Python.framework/Versions/3.7/lib/python3.7/site-packages/ccdproc/image_collection.py:546: UserWarning: Header from file &quot;/Users/jzamorano/Desktop/NOT_2008/N1/zt_ALrd120143.fits&quot; contains multiple entries for &quot;mjd-obs&quot;, the pair &quot;mjd-obs=54569.230740741&quot; will be ignored.
  UserWarning)
/Library/Frameworks/Python.framework/Versions/3.7/lib/python3.7/site-packages/ccdproc/image_collection.py:546: UserWarning: Header from file &quot;/Users/jzamorano/Desktop/NOT_2008/N1/zt_ALrd120144.fits&quot; contains multiple entries for &quot;mjd-obs&quot;, the pair &quot;mjd-obs=54569.235243056&quot; will be ignored.
  UserWarning)
/Library/Frameworks/Python.framework/Versions/3.7/lib/python3.7/site-packages/ccdproc/image_collection.py:546: UserWarning: Header from file &quot;/Users/jzamorano/Desktop/NOT_2008/N1/zt_ALrd120145.fits&quot; contains multiple entries for &quot;mjd-obs&quot;, the pair &quot;mjd-obs=54569.239722222&quot; will be ignored.
  UserWarning)
/Library/Frameworks/Python.framework/Versions/3.7/lib/python3.7/site-packages/ccdproc/image_collection.py:546: UserWarning: Header from file &quot;/Users/jzamorano/Desktop/NOT_2008/N1/zt_ALrd120146.fits&quot; contains multiple entries for &quot;mjd-obs&quot;, the pair &quot;mjd-obs=54569.245185185&quot; will be ignored.
  UserWarning)
</pre></div>
</div>
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[&#39;file&#39;, &#39;imagetyp&#39;, &#39;OBJECT&#39;, &#39;EXPTIME&#39;, &#39;ALFLTID&#39;, &#39;FAFLTID&#39;, &#39;FBFLTID&#39;]
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">keys</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[&#39;imagetyp&#39;, &#39;OBJECT&#39;, &#39;EXPTIME&#39;, &#39;ALFLTID&#39;, &#39;FAFLTID&#39;, &#39;FBFLTID&#39;]
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">list_of_flats</span> <span class="o">=</span> <span class="n">ic1</span><span class="o">.</span><span class="n">files_filtered</span><span class="p">(</span><span class="n">regex_match</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span><span class="nb">object</span><span class="o">=</span><span class="s1">&#39;flat&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">list_of_flats</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[&#39;zt_ALrd120011.fits&#39; &#39;zt_ALrd120012.fits&#39; &#39;zt_ALrd120013.fits&#39;
 &#39;zt_ALrd120014.fits&#39; &#39;zt_ALrd120015.fits&#39; &#39;zt_ALrd120016.fits&#39;
 &#39;zt_ALrd120017.fits&#39; &#39;zt_ALrd120018.fits&#39; &#39;zt_ALrd120019.fits&#39;
 &#39;zt_ALrd120020.fits&#39; &#39;zt_ALrd120021.fits&#39; &#39;zt_ALrd120022.fits&#39;
 &#39;zt_ALrd120023.fits&#39; &#39;zt_ALrd120024.fits&#39; &#39;zt_ALrd120025.fits&#39;
 &#39;zt_ALrd120026.fits&#39; &#39;zt_ALrd120027.fits&#39; &#39;zt_ALrd120028.fits&#39;
 &#39;zt_ALrd120029.fits&#39; &#39;zt_ALrd120030.fits&#39; &#39;zt_ALrd120031.fits&#39;
 &#39;zt_ALrd120032.fits&#39; &#39;zt_ALrd120033.fits&#39; &#39;zt_ALrd120034.fits&#39;
 &#39;zt_ALrd120035.fits&#39; &#39;zt_ALrd120036.fits&#39; &#39;zt_ALrd120037.fits&#39;
 &#39;zt_ALrd120038.fits&#39; &#39;zt_ALrd120039.fits&#39; &#39;zt_ALrd120040.fits&#39;
 &#39;zt_ALrd120041.fits&#39; &#39;zt_ALrd120042.fits&#39; &#39;zt_ALrd120043.fits&#39;
 &#39;zt_ALrd120044.fits&#39; &#39;zt_ALrd120045.fits&#39; &#39;zt_ALrd120046.fits&#39;
 &#39;zt_ALrd120047.fits&#39; &#39;zt_ALrd120048.fits&#39; &#39;zt_ALrd120049.fits&#39;
 &#39;zt_ALrd120050.fits&#39; &#39;zt_ALrd120051.fits&#39; &#39;zt_ALrd120052.fits&#39;
 &#39;zt_ALrd120053.fits&#39; &#39;zt_ALrd120054.fits&#39; &#39;zt_ALrd120055.fits&#39;
 &#39;zt_ALrd120056.fits&#39; &#39;zt_ALrd120057.fits&#39; &#39;zt_ALrd120058.fits&#39;
 &#39;zt_ALrd120059.fits&#39; &#39;zt_ALrd120060.fits&#39; &#39;zt_ALrd120061.fits&#39;
 &#39;zt_ALrd120062.fits&#39;]
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">list_of_flats</span><span class="p">)):</span>
    <span class="n">HDUList_object</span> <span class="o">=</span> <span class="n">fits</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">directory</span><span class="o">+</span><span class="n">list_of_flats</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
    <span class="n">primary_header</span> <span class="o">=</span> <span class="n">HDUList_object</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">header</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">primary_header</span><span class="p">[</span><span class="s1">&#39;FILENAME&#39;</span><span class="p">],</span><span class="n">primary_header</span><span class="p">[</span><span class="s1">&#39;OBJECT&#39;</span><span class="p">],</span><span class="n">primary_header</span><span class="p">[</span><span class="s1">&#39;exptime&#39;</span><span class="p">]</span>
          <span class="p">,</span><span class="n">primary_header</span><span class="p">[</span><span class="s1">&#39;ALFLTID&#39;</span><span class="p">],</span><span class="n">primary_header</span><span class="p">[</span><span class="s1">&#39;FBFLTID&#39;</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>zt_ALrd120011.fits Dome Flat R 1.0 76 0
zt_ALrd120012.fits Dome Flat R 1.0 76 0
zt_ALrd120013.fits Dome Flat R 1.0 76 0
zt_ALrd120014.fits Dome Flat R 1.0 76 0
zt_ALrd120015.fits Dome Flat R 1.0 76 0
zt_ALrd120016.fits Dome Flat R 1.0 76 0
zt_ALrd120017.fits Dome Flat R 1.0 76 0
zt_ALrd120018.fits Dome Flat R 1.0 76 0
zt_ALrd120019.fits Dome Flat R 1.0 76 0
zt_ALrd120020.fits Dome Flat R 1.0 76 0
zt_ALrd120021.fits Dome Flat NB#78 10.0 0 78
zt_ALrd120022.fits Dome Flat NB#49 30.0 0 49
zt_ALrd120023.fits Dome Flat NB#78 30.0 0 78
zt_ALrd120024.fits Dome Flat NB#78 30.0 0 78
zt_ALrd120025.fits Dome Flat NB#78 30.0 0 78
zt_ALrd120026.fits Dome Flat NB#78 30.0 0 78
zt_ALrd120027.fits Dome Flat NB#78 30.0 0 78
zt_ALrd120028.fits Dome Flat NB#78 30.0 0 78
zt_ALrd120029.fits Dome Flat NB#78 30.0 0 78
zt_ALrd120030.fits Dome Flat NB#78 30.0 0 78
zt_ALrd120031.fits Dome Flat NB#78 30.0 0 78
zt_ALrd120032.fits Dome Flat NB#78 30.0 0 78
zt_ALrd120033.fits Dome Flat NB#49 20.0 0 49
zt_ALrd120034.fits Dome Flat NB#49 20.0 0 49
zt_ALrd120035.fits Dome Flat NB#49 20.0 0 49
zt_ALrd120036.fits Dome Flat NB#49 20.0 0 49
zt_ALrd120037.fits Dome Flat NB#49 20.0 0 49
zt_ALrd120038.fits Dome Flat NB#49 20.0 0 49
zt_ALrd120039.fits Dome Flat NB#49 20.0 0 49
zt_ALrd120040.fits Dome Flat NB#49 20.0 0 49
zt_ALrd120041.fits Dome Flat NB#49 20.0 0 49
zt_ALrd120042.fits Dome Flat NB#49 20.0 0 49
zt_ALrd120043.fits Dome Flat NB#49 10.0 0 49
zt_ALrd120044.fits Sky Flat evening 0.1 0 78
zt_ALrd120045.fits Sky Flat evening 1.199 0 78
zt_ALrd120046.fits Sky Flat evening 3.5 0 78
zt_ALrd120047.fits Sky Flat evening 5.0 0 78
zt_ALrd120048.fits Sky Flat evening 7.5 0 78
zt_ALrd120049.fits Sky Flat evening 11.0 0 78
zt_ALrd120050.fits Sky Flat evening 17.0 0 78
zt_ALrd120051.fits Sky Flat evening 18.0 0 49
zt_ALrd120052.fits Sky Flat evening 27.0 0 49
zt_ALrd120053.fits Sky Flat evening 43.0 0 49
zt_ALrd120054.fits Sky Flat evening 10.0 0 49
zt_ALrd120055.fits Sky Flat evening 22.0 0 49
zt_ALrd120056.fits Sky Flat evening 33.0 0 49
zt_ALrd120057.fits Sky Flat evening 2.5 76 0
zt_ALrd120058.fits Sky Flat evening 3.299 76 0
zt_ALrd120059.fits Sky Flat evening 4.9 76 0
zt_ALrd120060.fits Sky Flat evening 7.0 76 0
zt_ALrd120061.fits Sky Flat evening 10.0 76 0
zt_ALrd120062.fits Sky Flat evening 15.0 76 0
</pre></div>
</div>
</div>
</div>
<p>The broad band filters are located in ‘ALFLTID’ while the narrow band are in the FASU B ‘FBFLTID’</p>
</div>
<div class="section" id="statistics-and-display">
<h3><span class="section-number">7.5.1.3. </span>Statistics and display<a class="headerlink" href="#statistics-and-display" title="Permalink to this headline">¶</a></h3>
<div class="section" id="reading-the-files">
<h4><span class="section-number">7.5.1.3.1. </span>Reading the files<a class="headerlink" href="#reading-the-files" title="Permalink to this headline">¶</a></h4>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">image_flats</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">file</span> <span class="ow">in</span> <span class="n">list_of_flats</span><span class="p">:</span>
    <span class="n">image_flats</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">CCDData</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="n">directory</span><span class="o">+</span><span class="n">file</span><span class="p">))</span> <span class="c1">#, unit=&quot;adu&quot;))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>WARNING: FITSFixedWarning: RADECSYS= &#39;FK5 &#39; 
the RADECSYS keyword is deprecated, use RADESYSa. [astropy.wcs.wcs]
WARNING:astropy:FITSFixedWarning: RADECSYS= &#39;FK5 &#39; 
the RADECSYS keyword is deprecated, use RADESYSa.
WARNING: FITSFixedWarning: &#39;obsfix&#39; made the change &#39;Set OBSGEO-L to   -17.885083 from OBSGEO-[XYZ].
Set OBSGEO-B to    28.757278 from OBSGEO-[XYZ].
Set OBSGEO-H to     2378.994 from OBSGEO-[XYZ]&#39;. [astropy.wcs.wcs]
WARNING:astropy:FITSFixedWarning: &#39;obsfix&#39; made the change &#39;Set OBSGEO-L to   -17.885083 from OBSGEO-[XYZ].
Set OBSGEO-B to    28.757278 from OBSGEO-[XYZ].
Set OBSGEO-H to     2378.994 from OBSGEO-[XYZ]&#39;.
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="analysing-the-images-data">
<h4><span class="section-number">7.5.1.3.2. </span>Analysing the images data<a class="headerlink" href="#analysing-the-images-data" title="Permalink to this headline">¶</a></h4>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Filename          Object        exp Mean std min  max&#39;</span><span class="p">)</span>
<span class="n">exposure</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">list_of_flats</span><span class="p">)):</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">image_flats</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">header</span><span class="p">[</span><span class="s1">&#39;FILENAME&#39;</span><span class="p">],</span> 
          <span class="n">image_flats</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">header</span><span class="p">[</span><span class="s1">&#39;OBJECT&#39;</span><span class="p">],</span> 
          <span class="n">image_flats</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">header</span><span class="p">[</span><span class="s1">&#39;EXPTIME&#39;</span><span class="p">],</span> 
          <span class="nb">int</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">image_flats</span><span class="p">[</span><span class="n">i</span><span class="p">])),</span> 
          <span class="nb">int</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="n">image_flats</span><span class="p">[</span><span class="n">i</span><span class="p">])),</span> 
          <span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">image_flats</span><span class="p">[</span><span class="n">i</span><span class="p">]),</span> 
          <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">image_flats</span><span class="p">[</span><span class="n">i</span><span class="p">]))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Filename          Object        exp Mean std min  max
zt_ALrd120011.fits Dome Flat R 1.0 27142 1428 30.5 31854.0
zt_ALrd120012.fits Dome Flat R 1.0 27100 1427 49.5 31773.0
zt_ALrd120013.fits Dome Flat R 1.0 27155 1429 32.5 31698.0
zt_ALrd120014.fits Dome Flat R 1.0 27223 1433 34.5 31742.5
zt_ALrd120015.fits Dome Flat R 1.0 27123 1428 38.5 42562.0
zt_ALrd120016.fits Dome Flat R 1.0 27045 1423 33.5 31798.0
zt_ALrd120017.fits Dome Flat R 1.0 27142 1429 34.5 31516.5
zt_ALrd120018.fits Dome Flat R 1.0 27298 1437 33.5 31987.0
zt_ALrd120019.fits Dome Flat R 1.0 27311 1437 29.5 37468.5
zt_ALrd120020.fits Dome Flat R 1.0 27486 1447 48.5 39239.5
zt_ALrd120021.fits Dome Flat NB#78 10.0 6753 2509 -8.5 16666.0
zt_ALrd120022.fits Dome Flat NB#49 30.0 27904 13348 28.5 45106.5
zt_ALrd120023.fits Dome Flat NB#78 30.0 20303 7538 11.5 29560.5
zt_ALrd120024.fits Dome Flat NB#78 30.0 20363 7560 11.5 29627.0
zt_ALrd120025.fits Dome Flat NB#78 30.0 20356 7557 21.5 29766.0
zt_ALrd120026.fits Dome Flat NB#78 30.0 20313 7541 20.5 29711.0
zt_ALrd120027.fits Dome Flat NB#78 30.0 20242 7514 16.5 33439.5
zt_ALrd120028.fits Dome Flat NB#78 30.0 20229 7509 16.5 41590.0
zt_ALrd120029.fits Dome Flat NB#78 30.0 20227 7509 27.5 30235.5
zt_ALrd120030.fits Dome Flat NB#78 30.0 20333 7548 16.5 37827.5
zt_ALrd120031.fits Dome Flat NB#78 30.0 20320 7543 12.5 29711.5
zt_ALrd120032.fits Dome Flat NB#78 30.0 20320 7543 16.5 31909.0
zt_ALrd120033.fits Dome Flat NB#49 20.0 18595 8896 27.5 32448.5
zt_ALrd120034.fits Dome Flat NB#49 20.0 18572 8885 30.5 29703.0
zt_ALrd120035.fits Dome Flat NB#49 20.0 18546 8872 18.5 31540.0
zt_ALrd120036.fits Dome Flat NB#49 20.0 18626 8911 25.5 31379.0
zt_ALrd120037.fits Dome Flat NB#49 20.0 18628 8912 22.5 37198.0
zt_ALrd120038.fits Dome Flat NB#49 20.0 18631 8914 11.5 34507.0
zt_ALrd120039.fits Dome Flat NB#49 20.0 18540 8871 5.0 30516.0
zt_ALrd120040.fits Dome Flat NB#49 20.0 18525 8863 29.5 29800.5
zt_ALrd120041.fits Dome Flat NB#49 20.0 18524 8863 27.5 29628.0
zt_ALrd120042.fits Dome Flat NB#49 20.0 18527 8865 17.5 29785.5
zt_ALrd120043.fits Dome Flat NB#49 10.0 9613 4177 -2.5 26641.0
zt_ALrd120044.fits Sky Flat evening 0.1 2693 962 -29.0 6723.0
zt_ALrd120045.fits Sky Flat evening 1.199 8912 3405 13.5 65182.0
zt_ALrd120046.fits Sky Flat evening 3.5 20878 7435 32.5 34683.5
zt_ALrd120047.fits Sky Flat evening 5.0 22790 8114 27.5 32932.0
zt_ALrd120048.fits Sky Flat evening 7.5 24451 8705 46.5 35316.0
zt_ALrd120049.fits Sky Flat evening 11.0 23964 8531 33.5 39714.0
zt_ALrd120050.fits Sky Flat evening 17.0 23630 8412 34.5 34251.5
zt_ALrd120051.fits Sky Flat evening 18.0 22792 9472 31.5 37293.5
zt_ALrd120052.fits Sky Flat evening 27.0 21157 8792 29.5 33728.0
zt_ALrd120053.fits Sky Flat evening 43.0 19638 8161 26.0 37317.0
zt_ALrd120054.fits Sky Flat evening 10.0 12007 4971 27.0 19446.0
zt_ALrd120055.fits Sky Flat evening 22.0 18534 7674 28.5 30571.0
zt_ALrd120056.fits Sky Flat evening 33.0 18653 7723 24.5 32617.0
zt_ALrd120057.fits Sky Flat evening 2.5 25231 1442 40.5 33976.0
zt_ALrd120058.fits Sky Flat evening 3.299 24251 1387 28.5 38185.5
zt_ALrd120059.fits Sky Flat evening 4.9 25907 1485 37.5 30151.5
zt_ALrd120060.fits Sky Flat evening 7.0 26334 1506 45.5 35667.5
zt_ALrd120061.fits Sky Flat evening 10.0 26347 1608 56.5 65181.5
zt_ALrd120062.fits Sky Flat evening 15.0 27059 1688 68.5 65182.0
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="building-list-of-flats-files-for-each-filter">
<h4><span class="section-number">7.5.1.3.3. </span>Building list of flats files for each filter<a class="headerlink" href="#building-list-of-flats-files-for-each-filter" title="Permalink to this headline">¶</a></h4>
<p>With the information in the logbook and after inspecting the files we can prepare lists os FLATS for each filter.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">FF_list_78</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;120044&#39;</span> <span class="p">,</span> <span class="s1">&#39;120045&#39;</span> <span class="p">,</span> <span class="s1">&#39;120046&#39;</span> <span class="p">,</span> <span class="s1">&#39;120047&#39;</span>
            <span class="p">,</span> <span class="s1">&#39;120048&#39;</span> <span class="p">,</span> <span class="s1">&#39;120049&#39;</span> <span class="p">,</span> <span class="s1">&#39;120050&#39;</span><span class="p">]</span>
<span class="n">FF_list_49</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;120051&#39;</span> <span class="p">,</span> <span class="s1">&#39;120052&#39;</span> <span class="p">,</span> <span class="s1">&#39;120053&#39;</span> 
            <span class="p">,</span> <span class="s1">&#39;120054&#39;</span> <span class="p">,</span> <span class="s1">&#39;120055&#39;</span> <span class="p">,</span> <span class="s1">&#39;120056&#39;</span><span class="p">]</span>
<span class="n">FF_list_76</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;120057&#39;</span> <span class="p">,</span> <span class="s1">&#39;120058&#39;</span> <span class="p">,</span> <span class="s1">&#39;120059&#39;</span> 
            <span class="p">,</span> <span class="s1">&#39;120060&#39;</span> <span class="p">,</span> <span class="s1">&#39;120061&#39;</span> <span class="p">,</span> <span class="s1">&#39;120062&#39;</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="display-of-files">
<h4><span class="section-number">7.5.1.3.4. </span>Display of files<a class="headerlink" href="#display-of-files" title="Permalink to this headline">¶</a></h4>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">image_flats_78</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">file</span> <span class="ow">in</span> <span class="n">FF_list_78</span><span class="p">:</span>
    <span class="n">image_flats_78</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">CCDData</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="n">directory</span><span class="o">+</span><span class="s1">&#39;zt_ALrd&#39;</span><span class="o">+</span><span class="n">file</span><span class="o">+</span><span class="s1">&#39;.fits&#39;</span><span class="p">))</span> 
<span class="n">image_flats_49</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">file</span> <span class="ow">in</span> <span class="n">FF_list_49</span><span class="p">:</span>
    <span class="n">image_flats_49</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">CCDData</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="n">directory</span><span class="o">+</span><span class="s1">&#39;zt_ALrd&#39;</span><span class="o">+</span><span class="n">file</span><span class="o">+</span><span class="s1">&#39;.fits&#39;</span><span class="p">))</span> 
<span class="n">image_flats_76</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">file</span> <span class="ow">in</span> <span class="n">FF_list_76</span><span class="p">:</span>
    <span class="n">image_flats_76</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">CCDData</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="n">directory</span><span class="o">+</span><span class="s1">&#39;zt_ALrd&#39;</span><span class="o">+</span><span class="n">file</span><span class="o">+</span><span class="s1">&#39;.fits&#39;</span><span class="p">))</span> 
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># auxiliary function to display a rectangle and compute mean value within it</span>
<span class="k">def</span> <span class="nf">draw_rectangle</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">image_data</span><span class="p">,</span> <span class="n">x1</span><span class="p">,</span> <span class="n">x2</span><span class="p">,</span> <span class="n">y1</span><span class="p">,</span> <span class="n">y2</span><span class="p">,</span> <span class="n">color</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">((</span><span class="n">x1</span><span class="p">,</span> <span class="n">x1</span><span class="p">),</span> <span class="p">(</span><span class="n">y1</span><span class="p">,</span> <span class="n">y2</span><span class="p">),</span> <span class="n">color</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">((</span><span class="n">x2</span><span class="p">,</span> <span class="n">x2</span><span class="p">),</span> <span class="p">(</span><span class="n">y1</span><span class="p">,</span> <span class="n">y2</span><span class="p">),</span> <span class="n">color</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">((</span><span class="n">x1</span><span class="p">,</span> <span class="n">x2</span><span class="p">),</span> <span class="p">(</span><span class="n">y1</span><span class="p">,</span> <span class="n">y1</span><span class="p">),</span> <span class="n">color</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">((</span><span class="n">x1</span><span class="p">,</span> <span class="n">x2</span><span class="p">),</span> <span class="p">(</span><span class="n">y2</span><span class="p">,</span> <span class="n">y2</span><span class="p">),</span> <span class="n">color</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">text</span><span class="p">:</span>
        <span class="n">media</span> <span class="o">=</span> <span class="n">image_data</span><span class="p">[</span><span class="n">y1</span><span class="p">:</span><span class="n">y2</span><span class="p">,</span><span class="n">x1</span><span class="p">:</span><span class="n">x2</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
        <span class="n">std</span>   <span class="o">=</span> <span class="n">image_data</span><span class="p">[</span><span class="n">y1</span><span class="p">:</span><span class="n">y2</span><span class="p">,</span><span class="n">x1</span><span class="p">:</span><span class="n">x2</span><span class="p">]</span><span class="o">.</span><span class="n">std</span><span class="p">()</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">text</span><span class="p">((</span><span class="n">x1</span><span class="o">+</span><span class="n">x2</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> <span class="n">y1</span><span class="o">+</span><span class="p">(</span><span class="n">y2</span><span class="o">-</span><span class="n">y1</span><span class="p">)</span><span class="o">/</span><span class="mi">8</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">media</span><span class="p">)),</span> 
                <span class="n">ha</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span> <span class="n">va</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">color</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>        
        <span class="n">ax</span><span class="o">.</span><span class="n">text</span><span class="p">((</span><span class="n">x1</span><span class="o">+</span><span class="n">x2</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> <span class="n">y2</span><span class="o">-</span><span class="p">(</span><span class="n">y2</span><span class="o">-</span><span class="n">y1</span><span class="p">)</span><span class="o">/</span><span class="mi">8</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="nb">round</span><span class="p">(</span><span class="n">std</span><span class="p">,</span><span class="mi">1</span><span class="p">)),</span> 
                <span class="n">ha</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span> <span class="n">va</span><span class="o">=</span><span class="s1">&#39;top&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">color</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">media</span><span class="p">,</span> <span class="n">std</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">vmin</span><span class="p">,</span><span class="n">vmax</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span><span class="mi">50000</span>
<span class="n">i</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="mi">12</span><span class="p">))</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">FF_list_49</span><span class="p">)):</span>
        <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">img</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">image_flats_49</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;gray&#39;</span><span class="p">,</span> <span class="n">origin</span><span class="o">=</span><span class="s1">&#39;low&#39;</span><span class="p">,</span><span class="n">vmin</span><span class="o">=</span><span class="n">vmin</span><span class="p">,</span><span class="n">vmax</span><span class="o">=</span><span class="n">vmax</span><span class="p">)</span>
        <span class="c1">#ax.set_xlabel(&#39;X axis&#39;)</span>
        <span class="c1">#ax.set_ylabel(&#39;Y axis&#39;)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_xticks</span><span class="p">([])</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_yticks</span><span class="p">([])</span>
        <span class="n">draw_rectangle</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">image_flats_49</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">data</span><span class="p">,</span> <span class="mi">700</span><span class="p">,</span> <span class="mi">1200</span><span class="p">,</span> <span class="mi">500</span><span class="p">,</span> <span class="mi">1000</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">,</span><span class="n">text</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mi">800</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="n">image_flats_49</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">header</span><span class="p">[</span><span class="s1">&#39;FILENAME&#39;</span><span class="p">][</span><span class="mi">7</span><span class="p">:</span><span class="o">-</span><span class="mi">5</span><span class="p">],</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">15</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;w&#39;</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mi">400</span><span class="p">,</span><span class="mi">1800</span><span class="p">,</span><span class="s1">&#39;FLAT filter #49&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">15</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;y&#39;</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mi">100</span><span class="p">,</span> <span class="mi">1400</span><span class="p">,</span> <span class="n">image_flats_49</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">header</span><span class="p">[</span><span class="s1">&#39;DATE-OBS&#39;</span><span class="p">],</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">15</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mi">400</span><span class="p">,</span> <span class="mi">1200</span><span class="p">,</span> <span class="s1">&#39;exposure= &#39;</span><span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">image_flats_49</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">header</span><span class="p">[</span><span class="s1">&#39;exptime&#39;</span><span class="p">])</span> <span class="o">+</span><span class="s1">&#39;s&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">15</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">)</span>
        
        <span class="n">divider</span> <span class="o">=</span> <span class="n">make_axes_locatable</span><span class="p">(</span><span class="n">ax</span><span class="p">)</span>
        <span class="n">cax</span> <span class="o">=</span> <span class="n">divider</span><span class="o">.</span><span class="n">append_axes</span><span class="p">(</span><span class="s2">&quot;right&quot;</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="s2">&quot;5%&quot;</span><span class="p">,</span> <span class="n">pad</span><span class="o">=</span><span class="mf">0.05</span><span class="p">)</span>
        <span class="n">fig</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">img</span><span class="p">,</span> <span class="n">cax</span><span class="o">=</span><span class="n">cax</span><span class="p">)</span> <span class="c1">#, label=&#39;Number of counts&#39;)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
        <span class="n">i</span> <span class="o">=</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">1</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/ccdproc_05_Master_FLAT_v1_29_0.png" src="../_images/ccdproc_05_Master_FLAT_v1_29_0.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">vmin</span><span class="p">,</span><span class="n">vmax</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span><span class="mi">50000</span>
<span class="n">i</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="mi">16</span><span class="p">))</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">FF_list_76</span><span class="p">)):</span>
        <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">img</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">image_flats_76</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;gray&#39;</span><span class="p">,</span> <span class="n">origin</span><span class="o">=</span><span class="s1">&#39;low&#39;</span><span class="p">,</span><span class="n">vmin</span><span class="o">=</span><span class="n">vmin</span><span class="p">,</span><span class="n">vmax</span><span class="o">=</span><span class="n">vmax</span><span class="p">)</span>
        <span class="c1">#ax.set_xlabel(&#39;X axis&#39;)</span>
        <span class="c1">#ax.set_ylabel(&#39;Y axis&#39;)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_xticks</span><span class="p">([])</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_yticks</span><span class="p">([])</span>
        <span class="n">draw_rectangle</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">image_flats_78</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">data</span><span class="p">,</span> <span class="mi">700</span><span class="p">,</span> <span class="mi">1200</span><span class="p">,</span> <span class="mi">500</span><span class="p">,</span> <span class="mi">1000</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">,</span><span class="n">text</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mi">800</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="n">image_flats_76</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">header</span><span class="p">[</span><span class="s1">&#39;FILENAME&#39;</span><span class="p">][</span><span class="mi">7</span><span class="p">:</span><span class="o">-</span><span class="mi">5</span><span class="p">],</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">15</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;w&#39;</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mi">400</span><span class="p">,</span><span class="mi">1800</span><span class="p">,</span><span class="s1">&#39;FLAT filter #76&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">15</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;y&#39;</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mi">100</span><span class="p">,</span> <span class="mi">1400</span><span class="p">,</span> <span class="n">image_flats_76</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">header</span><span class="p">[</span><span class="s1">&#39;DATE-OBS&#39;</span><span class="p">],</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">15</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mi">400</span><span class="p">,</span> <span class="mi">1200</span><span class="p">,</span> <span class="s1">&#39;exposure= &#39;</span><span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">image_flats_76</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">header</span><span class="p">[</span><span class="s1">&#39;exptime&#39;</span><span class="p">])</span> <span class="o">+</span><span class="s1">&#39;s&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">15</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">)</span>
        <span class="n">divider</span> <span class="o">=</span> <span class="n">make_axes_locatable</span><span class="p">(</span><span class="n">ax</span><span class="p">)</span>
        <span class="n">cax</span> <span class="o">=</span> <span class="n">divider</span><span class="o">.</span><span class="n">append_axes</span><span class="p">(</span><span class="s2">&quot;right&quot;</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="s2">&quot;5%&quot;</span><span class="p">,</span> <span class="n">pad</span><span class="o">=</span><span class="mf">0.05</span><span class="p">)</span>
        <span class="n">fig</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">img</span><span class="p">,</span> <span class="n">cax</span><span class="o">=</span><span class="n">cax</span><span class="p">)</span> <span class="c1">#, label=&#39;Number of counts&#39;)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
        <span class="n">i</span> <span class="o">=</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">1</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/ccdproc_05_Master_FLAT_v1_30_0.png" src="../_images/ccdproc_05_Master_FLAT_v1_30_0.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">vmin</span><span class="p">,</span><span class="n">vmax</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span><span class="mi">40000</span>
<span class="n">i</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">14</span><span class="p">,</span> <span class="mi">12</span><span class="p">))</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">FF_list_78</span><span class="p">)):</span>
        <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">img</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">image_flats_78</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;gray&#39;</span><span class="p">,</span> <span class="n">origin</span><span class="o">=</span><span class="s1">&#39;low&#39;</span><span class="p">,</span><span class="n">vmin</span><span class="o">=</span><span class="n">vmin</span><span class="p">,</span><span class="n">vmax</span><span class="o">=</span><span class="n">vmax</span><span class="p">)</span>
        <span class="c1">#ax.set_xlabel(&#39;X axis&#39;)</span>
        <span class="c1">#ax.set_ylabel(&#39;Y axis&#39;)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_xticks</span><span class="p">([])</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_yticks</span><span class="p">([])</span>
        <span class="n">draw_rectangle</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">image_flats_78</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">data</span><span class="p">,</span> <span class="mi">700</span><span class="p">,</span> <span class="mi">1200</span><span class="p">,</span> <span class="mi">500</span><span class="p">,</span> <span class="mi">1000</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">,</span><span class="n">text</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="c1">#draw_rectangle(ax, image_flats_78[i].data, 1000, 1500, 1000, 1500, color=&#39;y&#39;,text=True)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mi">800</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="n">image_flats_78</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">header</span><span class="p">[</span><span class="s1">&#39;FILENAME&#39;</span><span class="p">][</span><span class="mi">7</span><span class="p">:</span><span class="o">-</span><span class="mi">5</span><span class="p">],</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">15</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;w&#39;</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mi">400</span><span class="p">,</span><span class="mi">1800</span><span class="p">,</span><span class="s1">&#39;FLAT filter #78&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">15</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;y&#39;</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mi">100</span><span class="p">,</span> <span class="mi">1400</span><span class="p">,</span> <span class="n">image_flats_78</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">header</span><span class="p">[</span><span class="s1">&#39;DATE-OBS&#39;</span><span class="p">],</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">15</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mi">400</span><span class="p">,</span> <span class="mi">1200</span><span class="p">,</span> <span class="s1">&#39;exposure= &#39;</span><span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">image_flats_78</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">header</span><span class="p">[</span><span class="s1">&#39;exptime&#39;</span><span class="p">])</span> <span class="o">+</span><span class="s1">&#39;s&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">15</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">)</span>

        <span class="n">divider</span> <span class="o">=</span> <span class="n">make_axes_locatable</span><span class="p">(</span><span class="n">ax</span><span class="p">)</span>
        <span class="n">cax</span> <span class="o">=</span> <span class="n">divider</span><span class="o">.</span><span class="n">append_axes</span><span class="p">(</span><span class="s2">&quot;right&quot;</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="s2">&quot;5%&quot;</span><span class="p">,</span> <span class="n">pad</span><span class="o">=</span><span class="mf">0.05</span><span class="p">)</span>
        <span class="n">fig</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">img</span><span class="p">,</span> <span class="n">cax</span><span class="o">=</span><span class="n">cax</span><span class="p">)</span> <span class="c1">#, label=&#39;Number of counts&#39;)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
        <span class="n">i</span> <span class="o">=</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">1</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/ccdproc_05_Master_FLAT_v1_31_0.png" src="../_images/ccdproc_05_Master_FLAT_v1_31_0.png" />
</div>
</div>
<p>The first two files has lower counts and we can choose to remove them from the combination to create the master FLAT.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#FF_list_78 = [&#39;120044&#39; , &#39;120045&#39; , &#39;120046&#39; , &#39;120047&#39;, &#39;120048&#39; , &#39;120049&#39; , &#39;120050&#39;]</span>
<span class="n">FF_list_78</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;120046&#39;</span> <span class="p">,</span> <span class="s1">&#39;120047&#39;</span><span class="p">,</span> <span class="s1">&#39;120048&#39;</span> <span class="p">,</span> <span class="s1">&#39;120049&#39;</span> <span class="p">,</span> <span class="s1">&#39;120050&#39;</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
</div>
</div>
<div class="section" id="combining-the-flats-images">
<h3><span class="section-number">7.5.1.4. </span>Combining the FLATS images<a class="headerlink" href="#combining-the-flats-images" title="Permalink to this headline">¶</a></h3>
<p>The FLAT correction should be made using a combined FLAT image (master FLAT) using multiple observations. The combination will get rid of the high values produced by the cosmic rays and also of posible images of stars. We will use the ccdproc package.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Some astropy packages </span>
<span class="kn">import</span> <span class="nn">ccdproc</span>
<span class="kn">from</span> <span class="nn">ccdproc</span> <span class="kn">import</span> <span class="n">CCDData</span><span class="p">,</span> <span class="n">Combiner</span>
<span class="kn">from</span> <span class="nn">astropy</span> <span class="kn">import</span> <span class="n">stats</span>
<span class="kn">from</span> <span class="nn">astropy.stats</span> <span class="kn">import</span> <span class="n">sigma_clip</span><span class="p">,</span> <span class="n">mad_std</span>
<span class="kn">from</span> <span class="nn">astropy.stats</span> <span class="kn">import</span> <span class="n">sigma_clipped_stats</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Combiner is a class for combining CCDData objects.</span>
<span class="c1"># https://ccdproc.readthedocs.io/en/latest/api/ccdproc.Combiner.html</span>
<span class="c1"># The Combiner class is used to combine together CCDData objects </span>
<span class="c1"># including the method for combining the data, rejecting outlying data, </span>
<span class="c1"># and weighting used for combining frames.</span>

<span class="n">combiner_49</span> <span class="o">=</span> <span class="n">Combiner</span><span class="p">(</span><span class="n">image_flats_49</span><span class="p">)</span>
<span class="n">combiner_76</span> <span class="o">=</span> <span class="n">Combiner</span><span class="p">(</span><span class="n">image_flats_76</span><span class="p">)</span>
<span class="n">combiner_78</span> <span class="o">=</span> <span class="n">Combiner</span><span class="p">(</span><span class="n">image_flats_78</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># clipping all values over 800 to remove cosmic rays hits </span>
<span class="c1">#combiner_76.minmax_clipping(min_clip=None, max_clip=38000)</span>
<span class="c1"># median combine </span>
<span class="n">master_flat_76</span> <span class="o">=</span> <span class="n">combiner_76</span><span class="o">.</span><span class="n">median_combine</span><span class="p">()</span>
<span class="n">master_flat_78</span> <span class="o">=</span> <span class="n">combiner_78</span><span class="o">.</span><span class="n">median_combine</span><span class="p">()</span>
<span class="n">master_flat_49</span> <span class="o">=</span> <span class="n">combiner_49</span><span class="o">.</span><span class="n">median_combine</span><span class="p">()</span>
<span class="c1"># median filter  </span>
<span class="c1"># master_flat_49_filtered = ccdproc.median_filter(master_flat_49, 3)</span>
<span class="c1"># master_flat_76_filtered = ccdproc.median_filter(master_flat_76, 3)</span>
</pre></div>
</div>
</div>
</div>
<p>Let display a region of one of the FLAT images and the master FLAT</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">matplotlib.colors</span> <span class="kn">import</span> <span class="n">LogNorm</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">axarr</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">ncols</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">nrows</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">2</span><span class="p">):</span>
    <span class="n">ax</span> <span class="o">=</span> <span class="n">axarr</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
    <span class="k">if</span> <span class="n">i</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">box</span> <span class="o">=</span> <span class="n">image_flats_76</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span><span class="o">.</span><span class="n">data</span>
        <span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;Flat number 6&#39;</span>
    <span class="k">if</span> <span class="n">i</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>  
        <span class="n">box</span> <span class="o">=</span> <span class="n">master_flat_76</span><span class="o">.</span><span class="n">data</span> <span class="c1"># We need to convert CCDdata to np.array</span>
        <span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;master Flat&#39;</span>
    <span class="n">img</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">box</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;gray&#39;</span><span class="p">,</span> <span class="n">origin</span><span class="o">=</span><span class="s1">&#39;low&#39;</span><span class="p">,</span> <span class="n">vmin</span><span class="o">=</span><span class="mi">25000</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=</span><span class="mi">29000</span><span class="p">)</span> <span class="c1">#,norm=LogNorm())</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mf">0.95</span><span class="p">,</span> <span class="mf">0.05</span><span class="p">,</span><span class="n">label</span><span class="p">,</span> <span class="n">ha</span><span class="o">=</span><span class="s1">&#39;right&#39;</span><span class="p">,</span> <span class="n">va</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;y&#39;</span><span class="p">,</span>
            <span class="n">transform</span><span class="o">=</span><span class="n">ax</span><span class="o">.</span><span class="n">transAxes</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">18</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_xticks</span><span class="p">([])</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_yticks</span><span class="p">([])</span>
    <span class="n">draw_rectangle</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">box</span><span class="p">,</span> <span class="mi">700</span><span class="p">,</span> <span class="mi">1200</span><span class="p">,</span> <span class="mi">700</span><span class="p">,</span> <span class="mi">1200</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">,</span><span class="n">text</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">divider</span> <span class="o">=</span> <span class="n">make_axes_locatable</span><span class="p">(</span><span class="n">ax</span><span class="p">)</span>
    <span class="n">cax</span> <span class="o">=</span> <span class="n">divider</span><span class="o">.</span><span class="n">append_axes</span><span class="p">(</span><span class="s2">&quot;right&quot;</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="s2">&quot;5%&quot;</span><span class="p">,</span> <span class="n">pad</span><span class="o">=</span><span class="mf">0.05</span><span class="p">)</span>
    <span class="n">fig</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">img</span><span class="p">,</span> <span class="n">cax</span><span class="o">=</span><span class="n">cax</span><span class="p">)</span>
    
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/ccdproc_05_Master_FLAT_v1_40_0.png" src="../_images/ccdproc_05_Master_FLAT_v1_40_0.png" />
</div>
</div>
</div>
<div class="section" id="normalizing-the-flats">
<h3><span class="section-number">7.5.1.5. </span>Normalizing the FLATS<a class="headerlink" href="#normalizing-the-flats" title="Permalink to this headline">¶</a></h3>
<p>Since we will divide all the files by their corresponding FLAT, it is convinient to normalize the master FLAT. The mean value of the normalized FLAT is around 1 and the division will not alter the level of the images. We do not need to worry about since the flat is scaled by the mean of master_flat by the ccdproc.flat_correct procedure.</p>
<p>Let us chack that this is the true using one science image taken with  filter #76</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">image</span> <span class="o">=</span> <span class="n">CCDData</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="n">filelist</span><span class="p">[</span><span class="mi">102</span><span class="p">])</span>
<span class="nb">print</span><span class="p">(</span><span class="n">image</span><span class="o">.</span><span class="n">header</span><span class="p">[</span><span class="s1">&#39;object&#39;</span><span class="p">],</span><span class="s1">&#39;  filter: &#39;</span><span class="p">,</span><span class="n">image</span><span class="o">.</span><span class="n">header</span><span class="p">[</span><span class="s1">&#39;ALFLTID&#39;</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>WARNING: FITSFixedWarning: RADECSYS= &#39;FK5 &#39; 
the RADECSYS keyword is deprecated, use RADESYSa. [astropy.wcs.wcs]
WARNING:astropy:FITSFixedWarning: RADECSYS= &#39;FK5 &#39; 
the RADECSYS keyword is deprecated, use RADESYSa.
WARNING: FITSFixedWarning: &#39;obsfix&#39; made the change &#39;Set OBSGEO-L to   -17.885083 from OBSGEO-[XYZ].
Set OBSGEO-B to    28.757278 from OBSGEO-[XYZ].
Set OBSGEO-H to     2378.994 from OBSGEO-[XYZ]&#39;. [astropy.wcs.wcs]
WARNING:astropy:FITSFixedWarning: &#39;obsfix&#39; made the change &#39;Set OBSGEO-L to   -17.885083 from OBSGEO-[XYZ].
Set OBSGEO-B to    28.757278 from OBSGEO-[XYZ].
Set OBSGEO-H to     2378.994 from OBSGEO-[XYZ]&#39;.
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>GC4496A R 3x300s   filter:  76
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">reduced_image</span> <span class="o">=</span> <span class="n">ccdproc</span><span class="o">.</span><span class="n">flat_correct</span><span class="p">(</span><span class="n">image</span><span class="p">,</span> <span class="n">master_flat_76</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">axarr</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">ncols</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">nrows</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">2</span><span class="p">):</span>
    <span class="n">ax</span> <span class="o">=</span> <span class="n">axarr</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
    <span class="k">if</span> <span class="n">i</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">box</span> <span class="o">=</span> <span class="n">image</span><span class="o">.</span><span class="n">data</span>
        <span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;original science image&#39;</span>
    <span class="k">if</span> <span class="n">i</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>  
        <span class="n">box</span> <span class="o">=</span> <span class="n">reduced_image</span><span class="o">.</span><span class="n">data</span> <span class="c1"># We need to convert CCDdata to np.array</span>
        <span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;after flat fielding&#39;</span>
    <span class="n">img</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">box</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;gray&#39;</span><span class="p">,</span> <span class="n">origin</span><span class="o">=</span><span class="s1">&#39;low&#39;</span><span class="p">,</span> <span class="n">vmin</span><span class="o">=</span><span class="mi">1300</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=</span><span class="mi">1800</span><span class="p">)</span> <span class="c1">#,norm=LogNorm())</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mf">0.95</span><span class="p">,</span> <span class="mf">0.05</span><span class="p">,</span><span class="n">label</span><span class="p">,</span> <span class="n">ha</span><span class="o">=</span><span class="s1">&#39;right&#39;</span><span class="p">,</span> <span class="n">va</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;y&#39;</span><span class="p">,</span>
            <span class="n">transform</span><span class="o">=</span><span class="n">ax</span><span class="o">.</span><span class="n">transAxes</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">18</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_xticks</span><span class="p">([])</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_yticks</span><span class="p">([])</span>
    <span class="n">draw_rectangle</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">box</span><span class="p">,</span> <span class="mi">700</span><span class="p">,</span> <span class="mi">1200</span><span class="p">,</span> <span class="mi">700</span><span class="p">,</span> <span class="mi">1200</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">,</span><span class="n">text</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">divider</span> <span class="o">=</span> <span class="n">make_axes_locatable</span><span class="p">(</span><span class="n">ax</span><span class="p">)</span>
    <span class="n">cax</span> <span class="o">=</span> <span class="n">divider</span><span class="o">.</span><span class="n">append_axes</span><span class="p">(</span><span class="s2">&quot;right&quot;</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="s2">&quot;5%&quot;</span><span class="p">,</span> <span class="n">pad</span><span class="o">=</span><span class="mf">0.05</span><span class="p">)</span>
    <span class="n">fig</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">img</span><span class="p">,</span> <span class="n">cax</span><span class="o">=</span><span class="n">cax</span><span class="p">)</span>
    
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/ccdproc_05_Master_FLAT_v1_45_0.png" src="../_images/ccdproc_05_Master_FLAT_v1_45_0.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">axarr</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">ncols</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">nrows</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">2</span><span class="p">):</span>
    <span class="n">ax</span> <span class="o">=</span> <span class="n">axarr</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
    <span class="k">if</span> <span class="n">i</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">box</span> <span class="o">=</span> <span class="n">image</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">1000</span><span class="p">,</span><span class="mi">0</span><span class="p">:</span><span class="mi">1000</span><span class="p">]</span>
        <span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;original science image&#39;</span>
    <span class="k">if</span> <span class="n">i</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>  
        <span class="n">box</span> <span class="o">=</span> <span class="n">reduced_image</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">1000</span><span class="p">,</span><span class="mi">0</span><span class="p">:</span><span class="mi">1000</span><span class="p">]</span> <span class="c1"># We need to convert CCDdata to np.array</span>
        <span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;after flat fielding&#39;</span>
    <span class="n">img</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">box</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;gray&#39;</span><span class="p">,</span> <span class="n">origin</span><span class="o">=</span><span class="s1">&#39;low&#39;</span><span class="p">,</span> <span class="n">vmin</span><span class="o">=</span><span class="mi">1300</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=</span><span class="mi">1500</span><span class="p">)</span> <span class="c1">#,norm=LogNorm())</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mf">0.95</span><span class="p">,</span> <span class="mf">0.05</span><span class="p">,</span><span class="n">label</span><span class="p">,</span> <span class="n">ha</span><span class="o">=</span><span class="s1">&#39;right&#39;</span><span class="p">,</span> <span class="n">va</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;y&#39;</span><span class="p">,</span>
            <span class="n">transform</span><span class="o">=</span><span class="n">ax</span><span class="o">.</span><span class="n">transAxes</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">18</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_xticks</span><span class="p">([])</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_yticks</span><span class="p">([])</span>
    <span class="n">draw_rectangle</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">box</span><span class="p">,</span> <span class="mi">200</span><span class="p">,</span> <span class="mi">800</span><span class="p">,</span> <span class="mi">200</span><span class="p">,</span> <span class="mi">800</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">,</span><span class="n">text</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">divider</span> <span class="o">=</span> <span class="n">make_axes_locatable</span><span class="p">(</span><span class="n">ax</span><span class="p">)</span>
    <span class="n">cax</span> <span class="o">=</span> <span class="n">divider</span><span class="o">.</span><span class="n">append_axes</span><span class="p">(</span><span class="s2">&quot;right&quot;</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="s2">&quot;5%&quot;</span><span class="p">,</span> <span class="n">pad</span><span class="o">=</span><span class="mf">0.05</span><span class="p">)</span>
    <span class="n">fig</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">img</span><span class="p">,</span> <span class="n">cax</span><span class="o">=</span><span class="n">cax</span><span class="p">)</span>
    
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/ccdproc_05_Master_FLAT_v1_46_0.png" src="../_images/ccdproc_05_Master_FLAT_v1_46_0.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">axarr</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">ncols</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">nrows</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">14</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">):</span>
    <span class="n">ax</span> <span class="o">=</span> <span class="n">axarr</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
    <span class="k">if</span> <span class="n">i</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">box</span> <span class="o">=</span> <span class="n">master_flat_49</span>
        <span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;master_flat_49&#39;</span>
    <span class="k">if</span> <span class="n">i</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>  
        <span class="n">box</span> <span class="o">=</span> <span class="n">master_flat_76</span> 
        <span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;master_flat_76&#39;</span>
    <span class="k">if</span> <span class="n">i</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>  
        <span class="n">box</span> <span class="o">=</span> <span class="n">master_flat_78</span> 
        <span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;master_flat_78&#39;</span>                
    <span class="n">img</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">box</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;gray&#39;</span><span class="p">,</span> <span class="n">origin</span><span class="o">=</span><span class="s1">&#39;low&#39;</span><span class="p">,</span> <span class="n">vmin</span><span class="o">=</span><span class="mi">20000</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=</span><span class="mi">35000</span><span class="p">)</span> <span class="c1">#,norm=LogNorm())</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mf">0.95</span><span class="p">,</span> <span class="mf">0.05</span><span class="p">,</span><span class="n">label</span><span class="p">,</span> <span class="n">ha</span><span class="o">=</span><span class="s1">&#39;right&#39;</span><span class="p">,</span> <span class="n">va</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;y&#39;</span><span class="p">,</span>
            <span class="n">transform</span><span class="o">=</span><span class="n">ax</span><span class="o">.</span><span class="n">transAxes</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">18</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_xticks</span><span class="p">([])</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_yticks</span><span class="p">([])</span>
    <span class="n">draw_rectangle</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">box</span><span class="o">.</span><span class="n">data</span><span class="p">,</span> <span class="mi">500</span><span class="p">,</span> <span class="mi">1200</span><span class="p">,</span> <span class="mi">500</span><span class="p">,</span> <span class="mi">1200</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;w&#39;</span><span class="p">,</span><span class="n">text</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">divider</span> <span class="o">=</span> <span class="n">make_axes_locatable</span><span class="p">(</span><span class="n">ax</span><span class="p">)</span>
    <span class="n">cax</span> <span class="o">=</span> <span class="n">divider</span><span class="o">.</span><span class="n">append_axes</span><span class="p">(</span><span class="s2">&quot;right&quot;</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="s2">&quot;5%&quot;</span><span class="p">,</span> <span class="n">pad</span><span class="o">=</span><span class="mf">0.05</span><span class="p">)</span>
    <span class="n">fig</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">img</span><span class="p">,</span> <span class="n">cax</span><span class="o">=</span><span class="n">cax</span><span class="p">)</span>
    
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/ccdproc_05_Master_FLAT_v1_47_0.png" src="../_images/ccdproc_05_Master_FLAT_v1_47_0.png" />
</div>
</div>
<div class="section" id="writting-the-master-flats">
<h4><span class="section-number">7.5.1.5.1. </span>Writting the Master FLATs<a class="headerlink" href="#writting-the-master-flats" title="Permalink to this headline">¶</a></h4>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Copy primary header from single dark file and copy into master_dark header</span>
<span class="n">master_flat_49</span><span class="o">.</span><span class="n">header</span> <span class="o">=</span> <span class="n">image_flats_49</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">header</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="n">master_flat_76</span><span class="o">.</span><span class="n">header</span> <span class="o">=</span> <span class="n">image_flats_76</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">header</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="n">master_flat_78</span><span class="o">.</span><span class="n">header</span> <span class="o">=</span> <span class="n">image_flats_78</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">header</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Replace FILENAME keyword and add information</span>
<span class="n">master_flat_49</span><span class="o">.</span><span class="n">header</span><span class="p">[</span><span class="s1">&#39;HISTORY&#39;</span><span class="p">]</span>  <span class="o">=</span> <span class="s1">&#39;super FLAT combining &#39;</span><span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">image_flats_49</span><span class="p">))</span> <span class="o">+</span> <span class="s1">&#39; FLATS images&#39;</span>
<span class="n">master_flat_49</span><span class="o">.</span><span class="n">header</span><span class="p">[</span><span class="s1">&#39;HISTORY&#39;</span><span class="p">]</span>  <span class="o">=</span>  <span class="nb">str</span><span class="p">(</span><span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">())[</span><span class="mi">0</span><span class="p">:</span><span class="mi">18</span><span class="p">]</span><span class="o">+</span><span class="s1">&#39; astropy median combine&#39;</span>
<span class="n">master_flat_49</span><span class="o">.</span><span class="n">header</span><span class="p">[</span><span class="s1">&#39;HISTORY&#39;</span><span class="p">]</span>  <span class="o">=</span> <span class="s1">&#39;FLATS images from &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">image_flats_49</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">header</span><span class="p">[</span><span class="s1">&#39;FILENAME&#39;</span><span class="p">])</span><span class="o">+</span><span class="s1">&#39; to &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">image_flats_49</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">header</span><span class="p">[</span><span class="s1">&#39;FILENAME&#39;</span><span class="p">])</span>
<span class="n">master_flat_49</span><span class="o">.</span><span class="n">header</span><span class="p">[</span><span class="s1">&#39;FILENAME&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;N1_master_flat_49&#39;</span> 
<span class="n">master_flat_76</span><span class="o">.</span><span class="n">header</span><span class="p">[</span><span class="s1">&#39;HISTORY&#39;</span><span class="p">]</span>  <span class="o">=</span> <span class="s1">&#39;super FLAT combining &#39;</span><span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">image_flats_76</span><span class="p">))</span> <span class="o">+</span> <span class="s1">&#39; FLATS images&#39;</span>
<span class="n">master_flat_76</span><span class="o">.</span><span class="n">header</span><span class="p">[</span><span class="s1">&#39;HISTORY&#39;</span><span class="p">]</span>  <span class="o">=</span>  <span class="nb">str</span><span class="p">(</span><span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">())[</span><span class="mi">0</span><span class="p">:</span><span class="mi">18</span><span class="p">]</span><span class="o">+</span><span class="s1">&#39; astropy median combine&#39;</span>
<span class="n">master_flat_76</span><span class="o">.</span><span class="n">header</span><span class="p">[</span><span class="s1">&#39;HISTORY&#39;</span><span class="p">]</span>  <span class="o">=</span> <span class="s1">&#39;FLATS images from &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">image_flats_76</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">header</span><span class="p">[</span><span class="s1">&#39;FILENAME&#39;</span><span class="p">])</span><span class="o">+</span><span class="s1">&#39; to &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">image_flats_76</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">header</span><span class="p">[</span><span class="s1">&#39;FILENAME&#39;</span><span class="p">])</span>
<span class="n">master_flat_76</span><span class="o">.</span><span class="n">header</span><span class="p">[</span><span class="s1">&#39;FILENAME&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;N1_master_flat_76&#39;</span> 
<span class="n">master_flat_78</span><span class="o">.</span><span class="n">header</span><span class="p">[</span><span class="s1">&#39;HISTORY&#39;</span><span class="p">]</span>  <span class="o">=</span> <span class="s1">&#39;super FLAT combining &#39;</span><span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">image_flats_78</span><span class="p">))</span> <span class="o">+</span> <span class="s1">&#39; FLATS images&#39;</span>
<span class="n">master_flat_78</span><span class="o">.</span><span class="n">header</span><span class="p">[</span><span class="s1">&#39;HISTORY&#39;</span><span class="p">]</span>  <span class="o">=</span>  <span class="nb">str</span><span class="p">(</span><span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">())[</span><span class="mi">0</span><span class="p">:</span><span class="mi">18</span><span class="p">]</span><span class="o">+</span><span class="s1">&#39; astropy median combine&#39;</span>
<span class="n">master_flat_78</span><span class="o">.</span><span class="n">header</span><span class="p">[</span><span class="s1">&#39;HISTORY&#39;</span><span class="p">]</span>  <span class="o">=</span> <span class="s1">&#39;FLATS images from &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">image_flats_78</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">header</span><span class="p">[</span><span class="s1">&#39;FILENAME&#39;</span><span class="p">])</span><span class="o">+</span><span class="s1">&#39; to &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">image_flats_78</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">header</span><span class="p">[</span><span class="s1">&#39;FILENAME&#39;</span><span class="p">])</span>
<span class="n">master_flat_78</span><span class="o">.</span><span class="n">header</span><span class="p">[</span><span class="s1">&#39;FILENAME&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;N1_master_flat_78&#39;</span> 
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">master_flat_49</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">directory</span><span class="o">+</span><span class="s1">&#39;flat_N1_49.fits&#39;</span><span class="p">,</span><span class="n">overwrite</span><span class="o">=</span><span class="s1">&#39;yes&#39;</span><span class="p">)</span>
<span class="n">master_flat_76</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">directory</span><span class="o">+</span><span class="s1">&#39;flat_N1_76.fits&#39;</span><span class="p">,</span><span class="n">overwrite</span><span class="o">=</span><span class="s1">&#39;yes&#39;</span><span class="p">)</span>
<span class="n">master_flat_78</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">directory</span><span class="o">+</span><span class="s1">&#39;flat_N1_78.fits&#39;</span><span class="p">,</span><span class="n">overwrite</span><span class="o">=</span><span class="s1">&#39;yes&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./notebooks"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
        </div>
    </div>
    
    
    <div class='prev-next-bottom'>
        
    <a class='left-prev' id="prev-link" href="ccdproc_04_Substract_BIAS_v1.html" title="previous page"><span class="section-number">7.4. </span>ccdproc-04:   BIAS correction</a>
    <a class='right-next' id="next-link" href="ccdproc_06_Flatfielding_v1.html" title="next page"><span class="section-number">7.6. </span>ccdproc-06:   Flatfielding</a>

    </div>
    <footer class="footer mt-5 mt-md-0">
    <div class="container">
      <p>
        
          By J.Zamorano, N. Cardiel, S. Pascual and J. Gallego<br/>
        
            &copy; Copyright 2020.<br/>
      </p>
    </div>
  </footer>
</main>


      </div>
    </div>

    
  <script src="../_static/js/index.3da636dd464baa7582d2.js"></script>


    
  </body>
</html>